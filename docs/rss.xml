<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>慕然科技Scratch积木扩展库</title><link>https://ccwmoran.github.io/code</link><description>慕然科技官网https://ccwmoran.github.io</description><copyright>慕然科技Scratch积木扩展库</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://gpo.saobby.com/i/BA9EN3Rw3fzRUJmu.jpg</url><title>avatar</title><link>https://ccwmoran.github.io/code</link></image><lastBuildDate>Sun, 07 Dec 2025 13:17:24 +0000</lastBuildDate><managingEditor>慕然科技Scratch积木扩展库</managingEditor><ttl>60</ttl><webMaster>慕然科技Scratch积木扩展库</webMaster><item><title>慕然科技的灵动岛</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ling-dong-dao.html</link><description>```js
// 慕然科技的灵动岛 - Scratch 3.0扩展
// 扩展ID: moranldd
// 扩展名称: 慕然科技的灵动岛
// 文档: https://ccwmoran.github.io/code/

class MoranDynamicIslandExtension {
    constructor() {
        this.islandElement = null;
        this.islandVisible = true;
        this.currentState = 'compact'; // minimized, compact, expanded
        this.activities = [];
        this.currentActivityIndex = 0;
        
        // 默认样式配置 - 精确匹配iPhone灵动岛
        this.config = {
            position: { top: '15px', left: '50%' },
            colors: {
                background: 'rgba(28, 28, 30, 0.95)', // iOS深色背景
                text: '#FFFFFF',
                accent: '#0A84FF', // iOS系统蓝色
                progress: '#32D74B' // iOS绿色
            },
            dimensions: {
                minimized: { width: '40px', height: '40px', borderRadius: '20px' },
                compact: { width: '158px', height: '37px', borderRadius: '18.5px' },
                expanded: { width: '320px', minHeight: '180px', borderRadius: '22px' }
            },
            typography: {
                fontFamily: '-apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif',
                fontSize: { small: '13px', medium: '15px', large: '17px' },
                fontWeight: { regular: '400', semibold: '600', bold: '700' }
            }
        };
        
        // 圆形进度条配置
        this.circularProgress = {
            value: 0,
            size: 36,
            strokeWidth: 3,
            radius: 16
        };
        
        this.init();
    }

    getInfo() {
        return {
            id: 'moranldd',
            name: '慕然科技的灵动岛',
            color: '#1C1C1E',
            docsURI: 'https://ccwmoran.github.io/code/',
            blocks: [
                // 基础控制
                {
                    opcode: 'showIsland',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示灵动岛'
                },
                {
                    opcode: 'hideIsland',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '隐藏灵动岛'
                },
                {
                    opcode: 'setState',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置为[STATE]状态',
                    arguments: {
                        STATE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'stateMenu',
                            defaultValue: 'compact'
                        }
                    }
                },
                
                // 内容管理
                {
                    opcode: 'setContent',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置内容 标题:[TITLE] 副标题:[SUBTITLE]',
                    arguments: {
                        TITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '灵动岛'
                        },
                        SUBTITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '慕然科技'
                        }
                    }
                },
                {
                    opcode: 'setIcon',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置图标[ICON]',
                    arguments: {
                        ICON: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '●'
                        }
                    }
                },
                {
                    opcode: 'setProgress',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置圆形进度[PERCENT]%',
                    arguments: {
                        PERCENT: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 50
                        }
                    }
                },
                
                // 活动管理
                {
                    opcode: 'addActivity',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '添加活动 标题:[TITLE]',
                    arguments: {
                        TITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '新活动'
                        }
                    }
                },
                {
                    opcode: 'nextActivity',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '切换到下一个活动'
                },
                {
                    opcode: 'clearActivities',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '清空所有活动'
                },
                
                // 样式定制
                {
                    opcode: 'setPosition',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置位置 X:[X]% Y:[Y]px',
                    arguments: {
                        X: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 50
                        },
                        Y: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 15
                        }
                    }
                },
                {
                    opcode: 'setAccentColor',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置强调色[COLOR]',
                    arguments: {
                        COLOR: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '#0A84FF'
                        }
                    }
                },
                
                // 重置功能
                {
                    opcode: 'resetAll',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '重置所有设置'
                },
                
                // 事件与报告
                {
                    opcode: 'whenClicked',
                    blockType: Scratch.BlockType.HAT,
                    text: '当灵动岛被点击时',
                    isEdgeActivated: false
                },
                {
                    opcode: 'whenStateChanged',
                    blockType: Scratch.BlockType.HAT,
                    text: '当状态改变时',
                    isEdgeActivated: true
                },
                {
                    opcode: 'getCurrentState',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '当前状态'
                },
                {
                    opcode: 'getActivityCount',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '活动数量'
                },
                {
                    opcode: 'isVisible',
                    blockType: Scratch.BlockType.BOOLEAN,
                    text: '是否显示？'
                }
            ],
            menus: {
                stateMenu: {
                    acceptReporters: true,
                    items: [
                        { text: '最小型', value: 'minimized' },
                        { text: '紧凑型', value: 'compact' },
                        { text: '扩展型', value: 'expanded' }
                    ]
                }
            }
        };
    }

    // 初始化灵动岛
    init() {
        if (typeof document === 'undefined') return;
        
        // 移除已存在的元素
        const existing = document.getElementById('moran-dynamic-island');
        if (existing) existing.remove();
        
        // 创建主容器
        this.islandElement = document.createElement('div');
        this.islandElement.id = 'moran-dynamic-island';
        
        // 应用基础样式
        this.applyBaseStyles();
        
        // 添加事件监听
        this.setupEventListeners();
        
        // 添加到页面
        document.body.appendChild(this.islandElement);
        
        // 初始内容
        this.activities = [{
            id: 'default',
            title: '灵动岛',
            subtitle: '慕然科技',
            icon: '●',
            progress: 0
        }];
        
        this.updateDisplay();
    }

    // 应用基础样式
    applyBaseStyles() {
        this.islandElement.style.cssText = `
            position: fixed;
            z-index: 10000;
            transform: translateX(-50%);
            top: ${this.config.position.top};
            left: ${this.config.position.left};
            user-select: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        `;
    }

    // 设置事件监听
    setupEventListeners() {
        let touchStartTime = 0;
        let touchStartX = 0;
        let isDragging = false;
        
        // 触摸事件
        this.islandElement.addEventListener('touchstart', (e) =&gt; {
            touchStartTime = Date.now();
            touchStartX = e.touches[0].clientX;
            isDragging = false;
        });
        
        this.islandElement.addEventListener('touchmove', (e) =&gt; {
            const deltaX = Math.abs(e.touches[0].clientX - touchStartX);
            if (deltaX &gt; 10) isDragging = true;
        });
        
        this.islandElement.addEventListener('touchend', (e) =&gt; {
            const touchDuration = Date.now() - touchStartTime;
            const deltaX = e.changedTouches[0].clientX - touchStartX;
            
            if (isDragging &amp;&amp; Math.abs(deltaX) &gt; 30) {
                // 滑动切换活动
                this.nextActivity();
            } else if (touchDuration &gt; 500) {
                // 长按切换状态
                this.toggleState();
            } else if (!isDragging) {
                // 点击事件
                this.handleClick();
            }
        });
        
        // 鼠标事件
        this.islandElement.addEventListener('mousedown', (e) =&gt; {
            touchStartTime = Date.now();
            touchStartX = e.clientX;
            isDragging = false;
        });
        
        this.islandElement.addEventListener('mousemove', (e) =&gt; {
            if (!touchStartX) return;
            const deltaX = Math.abs(e.clientX - touchStartX);
            if (deltaX &gt; 10) isDragging = true;
        });
        
        this.islandElement.addEventListener('mouseup', (e) =&gt; {
            const clickDuration = Date.now() - touchStartTime;
            const deltaX = e.clientX - touchStartX;
            
            if (isDragging &amp;&amp; Math.abs(deltaX) &gt; 30) {
                this.nextActivity();
            } else if (clickDuration &gt; 500) {
                this.toggleState();
            } else if (!isDragging) {
                this.handleClick();
            }
            
            touchStartX = 0;
        });
    }

    // 切换状态
    toggleState() {
        const states = ['minimized', 'compact', 'expanded'];
        const currentIndex = states.indexOf(this.currentState);
        const nextIndex = (currentIndex + 1) % states.length;
        
        this.setState({ STATE: states[nextIndex] });
        Scratch.vm.runtime.startHats('moranldd_whenStateChanged');
    }

    // 处理点击
    handleClick() {
        Scratch.vm.runtime.startHats('moranldd_whenClicked');
    }

    // 更新显示
    updateDisplay() {
        if (!this.islandElement || this.activities.length === 0) return;
        
        const activity = this.activities[this.currentActivityIndex];
        
        // 根据状态渲染
        switch (this.currentState) {
            case 'minimized':
                this.renderMinimizedView(activity);
                break;
            case 'compact':
                this.renderCompactView(activity);
                break;
            case 'expanded':
                this.renderExpandedView(activity);
                break;
        }
    }

    // 渲染最小型视图
    renderMinimizedView(activity) {
        const dim = this.config.dimensions.minimized;
        const progress = activity.progress || 0;
        
        // 创建圆形进度条SVG
        const circumference = 2 * Math.PI * this.circularProgress.radius;
        const offset = circumference - (progress / 100) * circumference;
        
        const progressSVG = progress &gt; 0 ? `
            &lt;svg width='${this.circularProgress.size}' height='${this.circularProgress.size}' 
                 style='position: absolute; top: 0; left: 0;'&gt;
                &lt;circle cx='${this.circularProgress.size/2}' cy='${this.circularProgress.size/2}' 
                        r='${this.circularProgress.radius}' 
                        fill='none' 
                        stroke='rgba(255,255,255,0.2)' 
                        stroke-width='${this.circularProgress.strokeWidth}'/&gt;
                &lt;circle cx='${this.circularProgress.size/2}' cy='${this.circularProgress.size/2}' 
                        r='${this.circularProgress.radius}' 
                        fill='none' 
                        stroke='${this.config.colors.progress}' 
                        stroke-width='${this.circularProgress.strokeWidth}'
                        stroke-dasharray='${circumference}'
                        stroke-dashoffset='${offset}'
                        transform='rotate(-90 ${this.circularProgress.size/2} ${this.circularProgress.size/2})'
                        stroke-linecap='round'/&gt;
            &lt;/svg&gt;
        ` : '';
        
        this.islandElement.innerHTML = `
            &lt;div style='
                width: ${dim.width};
                height: ${dim.height};
                border-radius: ${dim.borderRadius};
                background: ${this.config.colors.background};
                backdrop-filter: blur(20px) saturate(180%);
                -webkit-backdrop-filter: blur(20px) saturate(180%);
                border: 0.5px solid rgba(255, 255, 255, 0.08);
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                overflow: hidden;
                box-shadow: 0 4px 24px rgba(0, 0, 0, 0.25);
            '&gt;
                ${progressSVG}
                &lt;span style='
                    color: ${this.config.colors.text};
                    font-size: 16px;
                    font-weight: 600;
                    z-index: 1;
                '&gt;${activity.icon || '●'}&lt;/span&gt;
            &lt;/div&gt;
        `;
    }

    // 渲染紧凑型视图
    renderCompactView(activity) {
        const dim = this.config.dimensions.compact;
        
        this.islandElement.innerHTML = `
            &lt;div style='
                width: ${dim.width};
                height: ${dim.height};
                border-radius: ${dim.borderRadius};
                background: ${this.config.colors.background};
                backdrop-filter: blur(30px) saturate(180%);
                -webkit-backdrop-filter: blur(30px) saturate(180%);
                border: 0.5px solid rgba(255, 255, 255, 0.1);
                display: flex;
                align-items: center;
                padding: 0 16px;
                gap: 12px;
                box-shadow: 0 6px 30px rgba(0, 0, 0, 0.3);
                cursor: pointer;
                transition: all 0.2s ease;
            '&gt;
                &lt;span style='
                    color: ${this.config.colors.text};
                    font-size: 16px;
                    min-width: 16px;
                '&gt;${activity.icon || '●'}&lt;/span&gt;
                
                &lt;div style='flex: 1; overflow: hidden;'&gt;
                    &lt;div style='
                        color: ${this.config.colors.text};
                        font-size: 13px;
                        font-weight: 600;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        font-family: ${this.config.typography.fontFamily};
                    '&gt;${activity.title}&lt;/div&gt;
                    
                    ${activity.subtitle ? `
                        &lt;div style='
                            color: rgba(255, 255, 255, 0.7);
                            font-size: 11px;
                            font-weight: 400;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                            margin-top: 2px;
                            font-family: ${this.config.typography.fontFamily};
                        '&gt;${activity.subtitle}&lt;/div&gt;
                    ` : ''}
                &lt;/div&gt;
                
                ${this.activities.length &gt; 1 ? `
                    &lt;div style='
                        display: flex;
                        gap: 4px;
                    '&gt;
                        ${this.activities.map((_, i) =&gt; `
                            &lt;div style='
                                width: 4px;
                                height: 4px;
                                border-radius: 2px;
                                background: ${i === this.currentActivityIndex ? this.config.colors.accent : 'rgba(255,255,255,0.2)'};
                            '&gt;&lt;/div&gt;
                        `).join('')}
                    &lt;/div&gt;
                ` : ''}
            &lt;/div&gt;
        `;
        
        // 添加悬停效果
        const container = this.islandElement.firstChild;
        container.onmouseenter = () =&gt; {
            container.style.transform = 'scale(1.02)';
            container.style.boxShadow = '0 8px 35px rgba(0, 0, 0, 0.35)';
        };
        container.onmouseleave = () =&gt; {
            container.style.transform = 'scale(1)';
            container.style.boxShadow = '0 6px 30px rgba(0, 0, 0, 0.3)';
        };
    }

    // 渲染扩展型视图
    renderExpandedView(activity) {
        const dim = this.config.dimensions.expanded;
        const progress = activity.progress || 0;
        
        this.islandElement.innerHTML = `
            &lt;div style='
                width: ${dim.width};
                min-height: ${dim.minHeight};
                border-radius: ${dim.borderRadius};
                background: ${this.config.colors.background};
                backdrop-filter: blur(40px) saturate(180%);
                -webkit-backdrop-filter: blur(40px) saturate(180%);
                border: 0.5px solid rgba(255, 255, 255, 0.15);
                padding: 20px;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
                cursor: pointer;
            '&gt;
                &lt;div style='
                    color: ${this.config.colors.text};
                    text-align: center;
                    font-family: ${this.config.typography.fontFamily};
                '&gt;
                    &lt;div style='font-size: 24px; margin-bottom: 12px;'&gt;
                        ${activity.icon || '●'}
                    &lt;/div&gt;
                    
                    &lt;div style='
                        font-size: 17px;
                        font-weight: 600;
                        margin-bottom: 6px;
                    '&gt;${activity.title}&lt;/div&gt;
                    
                    ${activity.subtitle ? `
                        &lt;div style='
                            font-size: 13px;
                            color: rgba(255, 255, 255, 0.7);
                            margin-bottom: 20px;
                        '&gt;${activity.subtitle}&lt;/div&gt;
                    ` : ''}
                    
                    ${progress &gt; 0 ? `
                        &lt;div style='margin: 25px 0;'&gt;
                            &lt;div style='
                                font-size: 21px;
                                font-weight: 700;
                                color: ${this.config.colors.progress};
                                margin-bottom: 8px;
                            '&gt;${progress}%&lt;/div&gt;
                            
                            &lt;div style='
                                width: 100px;
                                height: 100px;
                                margin: 0 auto;
                                position: relative;
                            '&gt;
                                &lt;svg width='100' height='100'&gt;
                                    &lt;circle cx='50' cy='50' r='40' 
                                            fill='none' 
                                            stroke='rgba(255,255,255,0.1)' 
                                            stroke-width='8'/&gt;
                                    &lt;circle cx='50' cy='50' r='40' 
                                            fill='none' 
                                            stroke='${this.config.colors.progress}' 
                                            stroke-width='8'
                                            stroke-dasharray='251.2'
                                            stroke-dashoffset='${251.2 - (progress * 2.512)}'
                                            transform='rotate(-90 50 50)'
                                            stroke-linecap='round'/&gt;
                                &lt;/svg&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    ` : ''}
                    
                    &lt;div style='
                        font-size: 11px;
                        color: rgba(255, 255, 255, 0.5);
                        margin-top: 20px;
                        padding-top: 15px;
                        border-top: 0.5px solid rgba(255, 255, 255, 0.1);
                    '&gt;长按返回 • 滑动切换&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        `;
    }

    // ========== 积木实现 ==========
    
    showIsland() {
        if (this.islandElement) {
            this.islandElement.style.display = 'block';
            this.islandVisible = true;
        }
    }

    hideIsland() {
        if (this.islandElement) {
            this.islandElement.style.display = 'none';
            this.islandVisible = false;
        }
    }

    setState(args) {
        this.currentState = args.STATE;
        this.updateDisplay();
        return Scratch.vm.runtime.startHats('moranldd_whenStateChanged');
    }

    setContent(args) {
        if (this.activities.length &gt; 0) {
            this.activities[this.currentActivityIndex].title = args.TITLE;
            this.activities[this.currentActivityIndex].subtitle = args.SUBTITLE;
            this.updateDisplay();
        }
    }

    setIcon(args) {
        if (this.activities.length &gt; 0) {
            this.activities[this.currentActivityIndex].icon = args.ICON;
            this.updateDisplay();
        }
    }

    setProgress(args) {
        const percent = Math.max(0, Math.min(100, args.PERCENT));
        if (this.activities.length &gt; 0) {
            this.activities[this.currentActivityIndex].progress = percent;
            this.circularProgress.value = percent;
            this.updateDisplay();
        }
    }

    addActivity(args) {
        const newActivity = {
            id: `activity_${Date.now()}`,
            title: args.TITLE,
            subtitle: '',
            icon: '●',
            progress: 0
        };
        
        this.activities.push(newActivity);
        if (this.activities.length &gt; 3) this.activities.shift();
        this.updateDisplay();
    }

    nextActivity() {
        if (this.activities.length &lt;= 1) return;
        
        this.currentActivityIndex = (this.currentActivityIndex + 1) % this.activities.length;
        this.updateDisplay();
    }

    clearActivities() {
        this.activities = [{
            id: 'default',
            title: '灵动岛',
            subtitle: '慕然科技',
            icon: '●',
            progress: 0
        }];
        this.currentActivityIndex = 0;
        this.updateDisplay();
    }

    setPosition(args) {
        if (this.islandElement) {
            this.config.position.left = `${args.X}%`;
            this.config.position.top = `${args.Y}px`;
            this.applyBaseStyles();
        }
    }

    setAccentColor(args) {
        this.config.colors.accent = args.COLOR;
        this.updateDisplay();
    }

    resetAll() {
        // 重置所有配置
        this.config = {
            position: { top: '15px', left: '50%' },
            colors: {
                background: 'rgba(28, 28, 30, 0.95)',
                text: '#FFFFFF',
                accent: '#0A84FF',
                progress: '#32D74B'
            },
            dimensions: {
                minimized: { width: '40px', height: '40px', borderRadius: '20px' },
                compact: { width: '158px', height: '37px', borderRadius: '18.5px' },
                expanded: { width: '320px', minHeight: '180px', borderRadius: '22px' }
            },
            typography: {
                fontFamily: '-apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif',
                fontSize: { small: '13px', medium: '15px', large: '17px' },
                fontWeight: { regular: '400', semibold: '600', bold: '700' }
            }
        };
        
        this.circularProgress = {
            value: 0,
            size: 36,
            strokeWidth: 3,
            radius: 16
        };
        
        this.currentState = 'compact';
        this.clearActivities();
        this.applyBaseStyles();
        this.updateDisplay();
    }

    whenClicked() {
        return false; // Hat积木，由事件触发
    }

    whenStateChanged() {
        return false; // Hat积木，由事件触发
    }

    getCurrentState() {
        return this.currentState;
    }

    getActivityCount() {
        return this.activities.length;
    }

    isVisible() {
        return this.islandVisible;
    }
}

// 注册扩展
if (typeof Scratch !== 'undefined' &amp;&amp; Scratch.extensions) {
    Scratch.extensions.register(new MoranDynamicIslandExtension());
}
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ling-dong-dao.html</guid><pubDate>Sun, 07 Dec 2025 13:09:01 +0000</pubDate></item><item><title>慕然科技的积木隐藏</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ji-mu-yin-cang.html</link><description>&gt; 隐藏编辑器中所有积木
`慕然科技官网ccwmoran.github.io`
```js
(function(Scratch) {
    'use strict';
    const Blockly = Scratch.Blockly;

    class BiyuanExtension {
        constructor() {
            this.workspace = null;
            this.original = {
                domToBlock: null,
                setVisible: null,
                contextMenu: null
            };
            this.observer = null;
            this.checkInterval = null;
        }

        getInfo() {
            return {
                id: 'hide',
                name: '慕然科技的积木隐藏',
                color: '#00704A',
                blocks: []
            };
        }

        applyProtection() {
            // 保存原始引用
            const originalContextMenu = Blockly.ContextMenu;
            
            // 劫持积木创建
            this.original.domToBlock = Blockly.Xml.domToBlock;
            Blockly.Xml.domToBlock = (xml, ws) =&gt; {
                const block = this.original.domToBlock(xml, ws);
                this.superHide(block);
                return block;
            };

            // 重写可见性设置
            this.original.setVisible = Blockly.Block.prototype.setVisible;
            Blockly.Block.prototype.setVisible = function(visible) {
                return this.original.setVisible.call(this, visible &amp;&amp; false);
            };

            // 监控DOM变化
            this.observer = new MutationObserver(mutations =&gt; {
                mutations.forEach(mutation =&gt; {
                    const element = mutation.target;
                    if (element.classList?.contains('blocklyBlockCanvas') &amp;&amp; 
                        element.style.display !== 'none') {
                        element.style.display = 'none';
                    }
                });
            });

            // 修复this指向问题
            const self = this;
            this.original.contextMenu = originalContextMenu;
            Blockly.ContextMenu = function(...args) {
                const instance = new originalContextMenu(...args);
                instance.show = () =&gt; {};
                return instance;
            };
        }

        superHide(block) {
            // 多层隐藏技术
            block.setVisible(false);
            const svgRoot = block.getSvgRoot();
            if (svgRoot) {
                svgRoot.style.display = 'none';
                svgRoot.setAttribute('visibility', 'hidden');
                
                // 添加DOM监控
                this.observer.observe(svgRoot, {
                    attributes: true,
                    attributeFilter: ['style', 'visibility']
                });
            }
        }

        onInit() {
            this.workspace = Scratch.vm.runtime.work  space;
            this.applyProtection();
            
            // 初始隐藏
            this.workspace.getAllBlocks().forEach(block =&gt; {
                this.superHide(block);
            });
            
            // 定时检查
            this.checkInterval = setInterval(() =&gt; {
                this.workspace.getAllBlocks().forEach(block =&gt; {
                    if (block.isVisible() || 
                        (block.getSvgRoot()?.style.display !== 'none') ||
                        (block.getSvgRoot()?.getAttribute('visibility') === 'visible')) {
                        this.superHide(block);
                    }
                });
            }, 50);
        }

        onUnload() {
            // 恢复原始环境
            Blockly.Xml.domToBlock = this.original.domToBlock;
            if (Blockly.Block.prototype.setVisible) {
                Blockly.Block.prototype.setVisible = this.original.setVisible;
            }
            Blockly.ContextMenu = this.original.contextMenu;
            
            clearInterval(this.checkInterval);
            this.observer?.disconnect();
            
            // 恢复所有元素
            this.workspace.getAllBlocks().forEach(block =&gt; {
                const svgRoot = block.getSvgRoot();
                if (svgRoot) {
                    svgRoot.style.display = '';
                    svgRoot.removeAttribute('visibility');
                }
                block.setVisible(true);
            });
            this.workspace.resize();
        }
    }

    const ext = new BiyuanExtension();
    Scratch.extensions.register(ext);
    ext.runtime.once('PROJECT_LOADED', () =&gt; ext.onInit());
    ext.runtime.once('EXTENSION_UNLOADED', () =&gt; ext.onUnload());
})(Scratch);
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ji-mu-yin-cang.html</guid><pubDate>Mon, 01 Dec 2025 14:44:35 +0000</pubDate></item><item><title>慕然科技的微信风格弹窗</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-wei-xin-feng-ge-dan-chuang.html</link><description>```
(function(Scratch) {
    'use strict';
    
    // 扩展类定义
    class WeChatDialogs {
        constructor() {
            // 存储回调函数
            this.callbacks = {};
            // 存储当前激活的弹窗
            this.activeDialog = null;
        }
        
        getInfo() {
            return {
                id: 'wxtc',
                name: '微信弹窗',
                color1: '#07C160',
                color2: '#06AD56',
                color3: '#06AD56',
                docsURI: 'https://kejicx.github.io',
                blocks: [
                    {
                        opcode: 'showAlert',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '显示消息弹窗 内容 [CONTENT] 按钮文字 [BUTTON]',
                        arguments: {
                            CONTENT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '操作成功'
                            },
                            BUTTON: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '确定'
                            }
                        }
                    },
                    {
                        opcode: 'showConfirm',
                        blockType: Scratch.BlockType.BOOLEAN,
                        text: '显示确认弹窗 内容 [CONTENT] 确定文字 [OK] 取消文字 [CANCEL]',
                        arguments: {
                            CONTENT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '确定要执行此操作吗？'
                            },
                            OK: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '确定'
                            },
                            CANCEL: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '取消'
                            }
                        }
                    },
                    {
                        opcode: 'showPrompt',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '显示输入弹窗 内容 [CONTENT] 提示 [PLACEHOLDER] 确定文字 [OK] 取消文字 [CANCEL]',
                        arguments: {
                            CONTENT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '请输入内容'
                            },
                            PLACEHOLDER: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '在此输入...'
                            },
                            OK: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '确定'
                            },
                            CANCEL: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '取消'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getLastResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '上次弹窗结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastInput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '上次输入内容',
                        disableMonitor: true
                    },
                    {
                        opcode: 'isConfirmed',
                        blockType: Scratch.BlockType.BOOLEAN,
                        text: '上次是否确认',
                        disableMonitor: true
                    }
                ],
                menus: {}
            };
        }
        
        // 显示消息弹窗
        showAlert(args) {
            return new Promise((resolve) =&gt; {
                this._createDialog({
                    type: 'alert',
                    content: args.CONTENT,
                    buttonText: args.BUTTON,
                    onClose: () =&gt; {
                        this.lastResult = 'confirmed';
                        resolve();
                    }
                });
            });
        }
        
        // 显示确认弹窗
        showConfirm(args) {
            return new Promise((resolve) =&gt; {
                this._createDialog({
                    type: 'confirm',
                    content: args.CONTENT,
                    okText: args.OK,
                    cancelText: args.CANCEL,
                    onConfirm: () =&gt; {
                        this.lastResult = 'confirmed';
                        this.lastConfirmed = true;
                        resolve(true);
                    },
                    onCancel: () =&gt; {
                        this.lastResult = 'cancelled';
                        this.lastConfirmed = false;
                        resolve(false);
                    }
                });
            });
        }
        
        // 显示输入弹窗
        showPrompt(args) {
            return new Promise((resolve) =&gt; {
                this._createDialog({
                    type: 'prompt',
                    content: args.CONTENT,
                    placeholder: args.PLACEHOLDER,
                    okText: args.OK,
                    cancelText: args.CANCEL,
                    onConfirm: (inputValue) =&gt; {
                        this.lastResult = 'confirmed';
                        this.lastInput = inputValue || '';
                        this.lastConfirmed = true;
                        resolve(inputValue || '');
                    },
                    onCancel: () =&gt; {
                        this.lastResult = 'cancelled';
                        this.lastInput = '';
                        this.lastConfirmed = false;
                        resolve('');
                    }
                });
            });
        }
        
        // 获取上次弹窗结果
        getLastResult() {
            return this.lastResult || 'none';
        }
        
        // 获取上次输入内容
        getLastInput() {
            return this.lastInput || '';
        }
        
        // 获取上次是否确认
        isConfirmed() {
            return !!this.lastConfirmed;
        }
        
        // 创建弹窗的私有方法
        _createDialog(options) {
            // 如果已有弹窗，先关闭
            if (this.activeDialog) {
                this._closeDialog();
            }
            
            // 创建弹窗容器
            const dialog = document.createElement('div');
            dialog.className = 'wx-dialog-overlay';
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            `;
            
            // 创建弹窗内容
            const content = document.createElement('div');
            content.className = 'wx-dialog-content';
            content.style.cssText = `
                background: white;
                border-radius: 12px;
                width: 270px;
                overflow: hidden;
                animation: dialogShow 0.3s ease;
            `;
            
            // 添加CSS动画
            if (!document.getElementById('wx-dialog-styles')) {
                const style = document.createElement('style');
                style.id = 'wx-dialog-styles';
                style.textContent = `
                    @keyframes dialogShow {
                        from {
                            opacity: 0;
                            transform: translateY(-20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // 构建弹窗内容
            let dialogHTML = '';
            
            // 弹窗消息
            dialogHTML += `&lt;div style='padding: 20px 20px 15px; text-align: center; font-size: 17px; color: #333; line-height: 1.5;'&gt;${this._escapeHtml(options.content)}&lt;/div&gt;`;
            
            // 输入框（仅适用于输入弹窗）
            if (options.type === 'prompt') {
                dialogHTML += `
                    &lt;div style='padding: 0 20px 15px;'&gt;
                        &lt;input type='text' 
                               class='wx-dialog-input' 
                               placeholder='${this._escapeHtml(options.placeholder)}' 
                               style='width: 100%; 
                                      padding: 12px; 
                                      border: 1px solid #E5E5E5; 
                                      border-radius: 5px; 
                                      font-size: 15px; 
                                      outline: none;
                                      box-sizing: border-box;'&gt;
                    &lt;/div&gt;
                `;
            }
            
            // 按钮区域
            dialogHTML += `&lt;div style='display: flex; border-top: 1px solid #F0F0F0;'&gt;`;
            
            if (options.type === 'alert') {
                // 只有一个确定按钮
                dialogHTML += `
                    &lt;button class='wx-dialog-button confirm' 
                            style='flex: 1; 
                                   padding: 16px; 
                                   border: none; 
                                   background: none; 
                                   font-size: 17px; 
                                   color: #07C160; 
                                   cursor: pointer;'&gt;
                        ${this._escapeHtml(options.buttonText)}
                    &lt;/button&gt;
                `;
            } else {
                // 有取消和确定两个按钮
                dialogHTML += `
                    &lt;button class='wx-dialog-button cancel' 
                            style='flex: 1; 
                                   padding: 16px; 
                                   border: none; 
                                   background: none; 
                                   font-size: 17px; 
                                   color: #333; 
                                   cursor: pointer;
                                   border-right: 1px solid #F0F0F0;'&gt;
                        ${this._escapeHtml(options.cancelText)}
                    &lt;/button&gt;
                    &lt;button class='wx-dialog-button confirm' 
                            style='flex: 1; 
                                   padding: 16px; 
                                   border: none; 
                                   background: none; 
                                   font-size: 17px; 
                                   color: #07C160; 
                                   font-weight: 500; 
                                   cursor: pointer;'&gt;
                        ${this._escapeHtml(options.okText)}
                    &lt;/button&gt;
                `;
            }
            
            dialogHTML += `&lt;/div&gt;`;
            
            content.innerHTML = dialogHTML;
            dialog.appendChild(content);
            document.body.appendChild(dialog);
            
            this.activeDialog = dialog;
            
            // 添加事件监听
            const inputField = content.querySelector('.wx-dialog-input');
            const confirmButton = content.querySelector('.wx-dialog-button.confirm');
            const cancelButton = content.querySelector('.wx-dialog-button.cancel');
            
            const closeDialog = () =&gt; {
                this._closeDialog();
            };
            
            const handleConfirm = () =&gt; {
                if (options.type === 'prompt') {
                    const value = inputField ? inputField.value : '';
                    if (options.onConfirm) options.onConfirm(value);
                } else if (options.type === 'confirm') {
                    if (options.onConfirm) options.onConfirm();
                } else {
                    if (options.onClose) options.onClose();
                }
                closeDialog();
            };
            
            const handleCancel = () =&gt; {
                if (options.type === 'confirm' &amp;&amp; options.onCancel) {
                    options.onCancel();
                } else if (options.type === 'prompt' &amp;&amp; options.onCancel) {
                    options.onCancel();
                }
                closeDialog();
            };
            
            // 绑定事件
            if (confirmButton) {
                confirmButton.addEventListener('click', handleConfirm);
            }
            
            if (cancelButton) {
                cancelButton.addEventListener('click', handleCancel);
            }
            
            // 点击遮罩层关闭（仅适用于确认和输入弹窗）
            if (options.type !== 'alert') {
                dialog.addEventListener('click', (e) =&gt; {
                    if (e.target === dialog) {
                        handleCancel();
                    }
                });
            }
            
            // 输入框回车确认
            if (inputField) {
                inputField.addEventListener('keypress', (e) =&gt; {
                    if (e.key === 'Enter') {
                        handleConfirm();
                    }
                });
                
                // 自动聚焦输入框
                setTimeout(() =&gt; {
                    inputField.focus();
                }, 300);
            }
        }
        
        // 关闭弹窗
        _closeDialog() {
            if (this.activeDialog) {
                document.body.removeChild(this.activeDialog);
                this.activeDialog = null;
            }
        }
        
        // HTML转义
        _escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    }
    
    // 注册扩展
    Scratch.extensions.register(new WeChatDialogs());
})(Scratch);
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-wei-xin-feng-ge-dan-chuang.html</guid><pubDate>Mon, 01 Dec 2025 14:39:42 +0000</pubDate></item><item><title>Morgan的邮件发送</title><link>https://ccwmoran.github.io/code/post/Morgan-de-you-jian-fa-song.html</link><description>```js
(function(Scratch) {
    'use strict';
    
    class MorganMailExtension {
        constructor() {
            // 使用EmailJS作为邮件发送服务
            this.emailjsUserId = '';
            this.emailjsServiceId = '';
            this.emailjsTemplateId = '';
            this.isInitialized = false;
            
            this.colors = {
                primary: '#2E7D32',
                secondary: '#1B5E20',
                accent: '#4CAF50'
            };
        }
        
        getInfo() {
            return {
                id: 'Mmail',
                name: 'Morgan的邮件发送',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.accent,
                docsURI: 'https://www.emailjs.com/docs/',
                blocks: [
                    {
                        opcode: 'initializeEmailService',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '初始化邮件服务 UserID:[USER_ID] ServiceID:[SERVICE_ID] TemplateID:[TEMPLATE_ID]',
                        arguments: {
                            USER_ID: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'your_user_id'
                            },
                            SERVICE_ID: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'your_service_id'
                            },
                            TEMPLATE_ID: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'your_template_id'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'sendEmail',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '发送邮件 发件人:[FROM_EMAIL] 收件人:[TO_EMAIL] 主题:[SUBJECT] 内容:[CONTENT]',
                        arguments: {
                            FROM_EMAIL: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'sender@example.com'
                            },
                            TO_EMAIL: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'receiver@example.com'
                            },
                            SUBJECT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'Hello from Scratch!'
                            },
                            CONTENT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '这是一封来自Scratch的测试邮件。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/Morgan-de-you-jian-fa-song.html</guid><pubDate>Sun, 30 Nov 2025 13:35:37 +0000</pubDate></item><item><title>慕然科技的腾讯混元大模型对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-teng-xun-hun-yuan-da-mo-xing-dui-hua.html</link><description>```
(function(Scratch) {
    'use strict';
    
    class TencentHunyuanExtension {
        constructor() {
            this.apiKey = '';
            this.currentModel = 'hunyuan-turbo';
            this.webSearchEnabled = false;
            this.deepThinkingEnabled = false;
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.conversationHistory = [];
            this.isProcessing = false;
            
            // 腾讯混元模型映射[citation:2][citation:10]
            this.modelMap = {
                '混元Turbo': 'hunyuan-turbo',
                '混元Pro': 'hunyuan-pro',
                '混元标准': 'hunyuan-standard'
            };
            
            this.colors = {
                primary: '#006EFF',
                secondary: '#0052CC',
                accent: '#003D99'
            };
        }
        
        getInfo() {
            return {
                id: 'kjcxyb',
                name: '慕然科技的腾讯元宝对话',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.accent,
                docsURI: 'https://cloud.tencent.com/document/product/1729',
                blocks: [
                    {
                        opcode: 'setApiKey',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '设置API密钥 [KEY]',
                        arguments: {
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'setModel',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '使用模型 [MODEL]',
                        arguments: {
                            MODEL: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'models'
                            }
                        }
                    },
                    {
                        opcode: 'setWebSearch',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '联网搜索 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    {
                        opcode: 'setDeepThinking',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '深度思考 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getThinkingResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getThinkingTime',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考用时（秒）',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastOutput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '输出结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getCurrentModel',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '当前模型',
                        disableMonitor: true
                    },
                    '---',
                    {
                        opcode: 'sendMessage',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '发送消息 [MESSAGE]',
                        arguments: {
                            MESSAGE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '你好！请介绍一下你自己'
                            }
                        }
                    },
                    {
                        opcode: 'resetConversation',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '重置对话历史'
                    }
                ],
                menus: {
                    models: {
                        acceptReporters: false,
                        items: [
                            '混元Turbo',
                            '混元Pro',
                            '混元标准'
                        ]
                    },
                    switch: {
                        acceptReporters: false,
                        items: ['打开', '关闭']
                    }
                }
            };
        }
        
        setApiKey(args) {
            const key = args.KEY.trim();
            if (key) {
                this.apiKey = key;
                console.log('API密钥已设置');
            }
        }
        
        setModel(args) {
            const modelKey = args.MODEL;
            this.currentModel = this.modelMap[modelKey] || this.modelMap['混元Turbo'];
            console.log(`模型已设置为: ${modelKey} (${this.currentModel})`);
        }
        
        setWebSearch(args) {
            this.webSearchEnabled = (args.ENABLED === '打开');
            console.log(`联网搜索: ${this.webSearchEnabled ? '开启' : '关闭'}`);
        }
        
        setDeepThinking(args) {
            this.deepThinkingEnabled = (args.ENABLED === '打开');
            console.log(`深度思考: ${this.deepThinkingEnabled ? '开启' : '关闭'}`);
        }
        
        getThinkingResult() {
            if (!this.lastThinkingResult) return '暂无思考结果';
            return this.lastThinkingResult;
        }
        
        getThinkingTime() {
            if (this.lastThinkingTime === 0) return '0';
            return (Math.round(this.lastThinkingTime / 100) / 10).toString();
        }
        
        getLastOutput() {
            return this.lastResponse || '暂无输出结果';
        }
        
        getCurrentModel() {
            for (const [displayName, modelId] of Object.entries(this.modelMap)) {
                if (modelId === this.currentModel) {
                    return displayName;
                }
            }
            return this.currentModel;
        }
        
        resetConversation() {
            this.conversationHistory = [];
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            console.log('对话历史已重置');
        }
        
        sendMessage(args) {
            if (this.isProcessing) {
                return Promise.resolve('错误：上一个请求正在处理中，请稍后再试');
            }
            
            if (!this.apiKey) {
                return Promise.resolve('错误：请先设置API密钥');
            }
            
            const message = args.MESSAGE.trim();
            if (!message) {
                return Promise.resolve('错误：消息内容不能为空');
            }
            
            this.isProcessing = true;
            
            // 构建对话消息[citation:2][citation:9]
            const messages = [...this.conversationHistory];
            
            // 添加系统提示词
            let systemMessage = '你是一个有帮助的AI助手。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-teng-xun-hun-yuan-da-mo-xing-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 13:33:43 +0000</pubDate></item><item><title>慕然科技的豆包AI对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-dou-bao-AI-dui-hua.html</link><description>```js
(function(Scratch) {
    'use strict';
    
    class DouBaoChat {
        constructor() {
            this.apiKey = '';
            this.currentModel = 'Doubao-1.5-pro-32k';
            this.deepThinkingEnabled = false;
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            
            // 豆包模型映射
            this.modelMap = {
                '豆包-Pro': 'Doubao-1.5-pro-32k',
                '豆包-Lite': 'Doubao-1.5-lite-32k',
                '豆包-标准': 'Doubao-pro-32k'
            };
            
            this.colors = {
                primary: '#FF6B35',
                secondary: '#FF8E53',
                accent: '#FFA726'
            };
        }
        
        getInfo() {
            return {
                id: 'kjcxdb',
                name: '慕然科技的与豆包对话',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.accent,
                docsURI: 'https://docs.console.zenlayer.com/api-reference/cn/aigw/chat-completion/doubao/doubao-context-chat-completion',
                blocks: [
                    {
                        opcode: 'setApiKey',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '设置API密钥 [KEY]',
                        arguments: {
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'setModel',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '使用模型 [MODEL]',
                        arguments: {
                            MODEL: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'models'
                            }
                        }
                    },
                    {
                        opcode: 'setDeepThinking',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '深度思考 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getThinkingResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getThinkingTime',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考用时（秒）',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastOutput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '输出结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getCurrentModel',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '当前模型',
                        disableMonitor: true
                    },
                    '---',
                    {
                        opcode: 'sendMessage',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '发送消息 [MESSAGE]',
                        arguments: {
                            MESSAGE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '你好！请介绍一下你自己'
                            }
                        }
                    },
                    {
                        opcode: 'reset',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '重置对话'
                    }
                ],
                menus: {
                    models: {
                        acceptReporters: false,
                        items: [
                            '豆包-Pro',
                            '豆包-Lite', 
                            '豆包-标准'
                        ]
                    },
                    switch: {
                        acceptReporters: false,
                        items: ['打开', '关闭']
                    }
                }
            };
        }
        
        setApiKey(args) {
            const key = args.KEY.trim();
            if (key) {
                this.apiKey = key;
                console.log('API密钥已设置');
            }
        }
        
        setModel(args) {
            const modelKey = args.MODEL;
            this.currentModel = this.modelMap[modelKey] || this.modelMap['豆包-Pro'];
            console.log(`模型已设置为: ${modelKey} (${this.currentModel})`);
        }
        
        setDeepThinking(args) {
            this.deepThinkingEnabled = (args.ENABLED === '打开');
            console.log(`深度思考: ${this.deepThinkingEnabled ? '开启' : '关闭'}`);
        }
        
        getThinkingResult() {
            if (!this.lastThinkingResult) return '暂无思考结果';
            return this.lastThinkingResult;
        }
        
        getThinkingTime() {
            if (this.lastThinkingTime === 0) return '0';
            return (Math.round(this.lastThinkingTime / 100) / 10).toString();
        }
        
        getLastOutput() {
            return this.lastResponse || '暂无输出结果';
        }
        
        getCurrentModel() {
            for (const [displayName, modelId] of Object.entries(this.modelMap)) {
                if (modelId === this.currentModel) {
                    return displayName;
                }
            }
            return this.currentModel;
        }
        
        reset() {
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            console.log('对话已重置');
        }
        
        sendMessage(args) {
            if (this.isProcessing) {
                return Promise.resolve('错误：上一个请求正在处理中，请稍后再试');
            }
            
            if (!this.apiKey) {
                return Promise.resolve('错误：请先设置API密钥');
            }
            
            const message = args.MESSAGE.trim();
            if (!message) {
                return Promise.resolve('错误：消息内容不能为空');
            }
            
            this.isProcessing = true;
            
            // 构建豆包API请求数据[citation:3]
            const requestData = {
                model: this.currentModel,
                messages: [
                    {
                        role: 'user',
                        content: message
                    }
                ],
                stream: false,
                temperature: 0.7,
                max_tokens: 1024
            };
            
            // 如果开启深度思考，调整参数以获得更详细的响应
            if (this.deepThinkingEnabled) {
                requestData.temperature = 0.3; // 更低的温度以获得更集中的思考
                requestData.max_tokens = 2048; // 更多的token以容纳思考过程
            }
            
            const startTime = Date.now();
            
            // 调用豆包API[citation:3]
            return fetch('https://gateway.theturbo.ai/v1/context/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + this.apiKey,
                    'Accept': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
            .then(response =&gt; {
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                return response.json();
            })
            .then(data =&gt; {
                const endTime = Date.now();
                this.lastThinkingTime = endTime - startTime;
                
                if (data.error) {
                    throw new Error(data.error.message || 'API返回错误');
                }
                
                if (data.choices &amp;&amp; data.choices.length &gt; 0) {
                    const message = data.choices[0].message;
                    
                    // 获取响应内容
                    this.lastResponse = message.content || '无响应内容';
                    
                    // 构建思考结果信息
                    let thinkingInfo = '';
                    if (data.usage) {
                        thinkingInfo = `Tokens使用: 输入${data.usage.prompt_tokens} 输出${data.usage.completion_tokens} 总计${data.usage.total_tokens}`;
                    }
                    if (data.choices[0].finish_reason) {
                        thinkingInfo += thinkingInfo ? ` | 完成原因: ${data.choices[0].finish_reason}` : `完成原因: ${data.choices[0].finish_reason}`;
                    }
                    
                    // 如果是深度思考模式，尝试从响应中提取更多思考信息
                    if (this.deepThinkingEnabled) {
                        // 这里可以添加对思考过程的解析逻辑
                        // 豆包API可能不会直接返回思考过程，但我们可以记录一些元数据
                        thinkingInfo += ' | 深度思考模式: 已开启';
                    }
                    
                    this.lastThinkingResult = thinkingInfo || '无元数据信息';
                    
                    return this.lastResponse;
                } else {
                    throw new Error('API返回数据异常');
                }
            })
            .catch(error =&gt; {
                console.error('豆包API错误:', error);
                this.lastResponse = '';
                this.lastThinkingResult = '';
                return `错误：${error.message}`;
            })
            .finally(() =&gt; {
                this.isProcessing = false;
            });
        }
    }
    
    Scratch.extensions.register(new DouBaoChat());
})(Scratch);
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-dou-bao-AI-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 13:32:38 +0000</pubDate></item><item><title>慕然科技的ChatGPT对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ChatGPT-dui-hua.html</link><description>```
(function(Scratch) {
    'use strict';
    
    class ChatGPTExtension {
        constructor() {
            this.apiKey = '';
            this.currentModel = 'gpt-3.5-turbo';
            this.webSearchEnabled = false;
            this.deepThinkingEnabled = false;
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.conversationHistory = [];
            this.isProcessing = false;
            
            // OpenAI模型映射
            this.modelMap = {
                'GPT-3.5 Turbo': 'gpt-3.5-turbo',
                'GPT-4': 'gpt-4',
                'GPT-4 Turbo': 'gpt-4-turbo-preview'
            };
            
            this.colors = {
                primary: '#10A37F',
                secondary: '#0D8E6F',
                accent: '#0B7A5F'
            };
        }
        
        getInfo() {
            return {
                id: 'kjcxchatgpt',
                name: '慕然科技的ChatGPT对话',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.accent,
                docsURI: 'https://platform.openai.com/docs/api-reference/chat',
                blocks: [
                    {
                        opcode: 'setApiKey',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '设置API密钥 [KEY]',
                        arguments: {
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'setModel',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '使用模型 [MODEL]',
                        arguments: {
                            MODEL: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'models'
                            }
                        }
                    },
                    {
                        opcode: 'setWebSearch',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '联网搜索 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    {
                        opcode: 'setDeepThinking',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '深度思考 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getThinkingResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getThinkingTime',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考用时（秒）',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastOutput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '输出结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getCurrentModel',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '当前模型',
                        disableMonitor: true
                    },
                    '---',
                    {
                        opcode: 'sendMessage',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '发送消息 [MESSAGE]',
                        arguments: {
                            MESSAGE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '你好！请介绍一下你自己'
                            }
                        }
                    },
                    {
                        opcode: 'resetConversation',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '重置对话历史'
                    }
                ],
                menus: {
                    models: {
                        acceptReporters: false,
                        items: [
                            'GPT-3.5 Turbo',
                            'GPT-4',
                            'GPT-4 Turbo'
                        ]
                    },
                    switch: {
                        acceptReporters: false,
                        items: ['打开', '关闭']
                    }
                }
            };
        }
        
        setApiKey(args) {
            const key = args.KEY.trim();
            if (key) {
                this.apiKey = key;
                console.log('API密钥已设置');
            }
        }
        
        setModel(args) {
            const modelKey = args.MODEL;
            this.currentModel = this.modelMap[modelKey] || this.modelMap['GPT-3.5 Turbo'];
            console.log(`模型已设置为: ${modelKey} (${this.currentModel})`);
        }
        
        setWebSearch(args) {
            this.webSearchEnabled = (args.ENABLED === '打开');
            console.log(`联网搜索: ${this.webSearchEnabled ? '开启' : '关闭'}`);
        }
        
        setDeepThinking(args) {
            this.deepThinkingEnabled = (args.ENABLED === '打开');
            console.log(`深度思考: ${this.deepThinkingEnabled ? '开启' : '关闭'}`);
        }
        
        getThinkingResult() {
            if (!this.lastThinkingResult) return '暂无思考结果';
            return this.lastThinkingResult;
        }
        
        getThinkingTime() {
            if (this.lastThinkingTime === 0) return '0';
            return (Math.round(this.lastThinkingTime / 100) / 10).toString();
        }
        
        getLastOutput() {
            return this.lastResponse || '暂无输出结果';
        }
        
        getCurrentModel() {
            for (const [displayName, modelId] of Object.entries(this.modelMap)) {
                if (modelId === this.currentModel) {
                    return displayName;
                }
            }
            return this.currentModel;
        }
        
        resetConversation() {
            this.conversationHistory = [];
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            console.log('对话历史已重置');
        }
        
        sendMessage(args) {
            if (this.isProcessing) {
                return Promise.resolve('错误：上一个请求正在处理中，请稍后再试');
            }
            
            if (!this.apiKey) {
                return Promise.resolve('错误：请先设置API密钥');
            }
            
            const message = args.MESSAGE.trim();
            if (!message) {
                return Promise.resolve('错误：消息内容不能为空');
            }
            
            this.isProcessing = true;
            
            // 构建对话消息[citation:1]
            const messages = [...this.conversationHistory];
            
            // 添加系统提示词
            let systemMessage = '你是一个有帮助的AI助手。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-ChatGPT-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 13:28:06 +0000</pubDate></item><item><title>慕然科技的智谱清言对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-zhi-pu-qing-yan-dui-hua.html</link><description>```
(function(Scratch) {
    'use strict';
    
    class GLMChat {
        constructor() {
            this.apiKey = '';
            this.currentModel = 'glm-4-flash';
            this.webSearchEnabled = false;
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            
            this.modelMap = {
                'GLM-4-Flash': 'glm-4-flash',
                'GLM-4-Long': 'glm-4-long',
                'GLM-4-Air': 'glm-4-air',
                'GLM-4-AirX': 'glm-4-airx',
                'GLM-4-Plus': 'glm-4-plus',
                'GLM-4-0520': 'glm-4-0520',
                'GLM-4-0520-实验版': 'glm-4-0520-experimental',
                'GLM-4V': 'glm-4v',
                'GLM-4V-Plus': 'glm-4v-plus',
                'GLM-4V-0520': 'glm-4v-0520'
            };
            
            this.colors = {
                primary: '#2D5CF6',
                secondary: '#1A3FD9',
                accent: '#5B82F8'
            };
        }
        
        getInfo() {
            return {
                id: 'kjcxglm',
                name: '慕然科技的智谱清言',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.accent,
                docsURI: 'https://open.bigmodel.cn/',
                blocks: [
                    {
                        opcode: 'setApiKey',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '设置API密钥 [KEY]',
                        arguments: {
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'setModel',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '使用模型 [MODEL]',
                        arguments: {
                            MODEL: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'models'
                            }
                        }
                    },
                    {
                        opcode: 'setWebSearch',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '联网搜索 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getThinkingResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '思考结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getThinkingTime',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '思考用时（秒）',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastOutput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '输出结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getCurrentModel',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '当前模型',
                        disableMonitor: true
                    },
                    '---',
                    {
                        opcode: 'sendMessage',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '发送消息 [MESSAGE]',
                        arguments: {
                            MESSAGE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '你好！请介绍一下你自己'
                            }
                        }
                    },
                    {
                        opcode: 'reset',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '重置对话'
                    }
                ],
                menus: {
                    models: {
                        acceptReporters: false,
                        items: [
                            'GLM-4-Flash',
                            'GLM-4-Long', 
                            'GLM-4-Air',
                            'GLM-4-AirX',
                            'GLM-4-Plus',
                            'GLM-4-0520',
                            'GLM-4-0520-实验版',
                            'GLM-4V',
                            'GLM-4V-Plus',
                            'GLM-4V-0520'
                        ]
                    },
                    switch: {
                        acceptReporters: false,
                        items: ['打开', '关闭']
                    }
                }
            };
        }
        
        setApiKey(args) {
            const key = args.KEY.trim();
            if (key) {
                this.apiKey = key;
                console.log('API密钥已设置');
            }
        }
        
        setModel(args) {
            const modelKey = args.MODEL;
            this.currentModel = this.modelMap[modelKey] || this.modelMap['GLM-4-Flash'];
            console.log(`模型已设置为: ${modelKey} (${this.currentModel})`);
        }
        
        setWebSearch(args) {
            this.webSearchEnabled = (args.ENABLED === '打开');
            console.log(`联网搜索: ${this.webSearchEnabled ? '开启' : '关闭'}`);
        }
        
        getThinkingResult() {
            if (!this.lastThinkingResult) return '暂无思考结果';
            return this.lastThinkingResult;
        }
        
        getThinkingTime() {
            if (this.lastThinkingTime === 0) return '0';
            return (Math.round(this.lastThinkingTime / 100) / 10).toString();
        }
        
        getLastOutput() {
            return this.lastResponse || '暂无输出结果';
        }
        
        getCurrentModel() {
            for (const [displayName, modelId] of Object.entries(this.modelMap)) {
                if (modelId === this.currentModel) {
                    return displayName;
                }
            }
            return this.currentModel;
        }
        
        reset() {
            this.lastResponse = '';
            this.lastThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            console.log('对话已重置');
        }
        
        sendMessage(args) {
            if (this.isProcessing) {
                return Promise.resolve('错误：上一个请求正在处理中，请稍后再试');
            }
            
            if (!this.apiKey) {
                return Promise.resolve('错误：请先设置API密钥');
            }
            
            const message = args.MESSAGE.trim();
            if (!message) {
                return Promise.resolve('错误：消息内容不能为空');
            }
            
            this.isProcessing = true;
            
            const requestData = {
                model: this.currentModel,
                messages: [
                    {
                        role: 'user',
                        content: message
                    }
                ],
                stream: false
            };
            
            if (this.webSearchEnabled) {
                requestData.tools = [
                    {
                        type: 'web_search',
                        web_search: {
                            enable: true,
                            search_result: true
                        }
                    }
                ];
            }
            
            const startTime = Date.now();
            
            return fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + this.apiKey
                },
                body: JSON.stringify(requestData)
            })
            .then(response =&gt; {
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                return response.json();
            })
            .then(data =&gt; {
                const endTime = Date.now();
                this.lastThinkingTime = endTime - startTime;
                
                if (data.error) {
                    throw new Error(data.error.message || 'API返回错误');
                }
                
                if (data.choices &amp;&amp; data.choices.length &gt; 0) {
                    const message = data.choices[0].message;
                    
                    if (Array.isArray(message.content)) {
                        let textContent = '';
                        for (const item of message.content) {
                            if (item.type === 'text') {
                                textContent += item.text;
                            }
                        }
                        this.lastResponse = textContent;
                    } else {
                        this.lastResponse = message.content;
                    }
                    
                    let thinkingInfo = '';
                    if (data.usage) {
                        thinkingInfo = `Tokens: 输入${data.usage.prompt_tokens} 输出${data.usage.completion_tokens} 总计${data.usage.total_tokens}`;
                    }
                    if (data.choices[0].finish_reason) {
                        thinkingInfo += thinkingInfo ? ` | 完成原因: ${data.choices[0].finish_reason}` : `完成原因: ${data.choices[0].finish_reason}`;
                    }
                    this.lastThinkingResult = thinkingInfo || '无元数据信息';
                    
                    return this.lastResponse;
                } else {
                    throw new Error('API返回数据异常');
                }
            })
            .catch(error =&gt; {
                console.error('智谱清言API错误:', error);
                this.lastResponse = '';
                this.lastThinkingResult = '';
                return `错误：${error.message}`;
            })
            .finally(() =&gt; {
                this.isProcessing = false;
            });
        }
    }
    
    Scratch.extensions.register(new GLMChat());
})(Scratch);
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-zhi-pu-qing-yan-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 13:26:34 +0000</pubDate></item><item><title>慕然科技的DeepSeek对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-DeepSeek-dui-hua.html</link><description>[`慕然科技官网`](https://ccwmoran.github.io)
```js
(function(Scratch) {
    'use strict';
    
    // DeepSeek对话扩展类
    class DeepSeekDialogs {
        constructor() {
            // 扩展内部状态变量
            this.apiKey = '';
            this.currentModel = 'deepseek-chat';
            this.webSearchEnabled = false;
            this.deepThinkingEnabled = false;
            this.lastResponse = '';
            this.lastDeepThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            
            // 模型映射
            this.modelMap = {
                'V1': 'deepseek-chat',
                'V2': 'deepseek-coder',
                'V3': 'deepseek-reasoner',
                'V3.1': 'deepseek-reasoner'
            };
            
            // DeepSeek品牌颜色
            this.colors = {
                primary: '#1752EF',
                secondary: '#0F3AC4',
                accent: '#4A7AFF'
            };
        }
        
        getInfo() {
            return {
                id: 'kjcxds',
                name: '慕然科技的新DeepSeek对话',
                color1: this.colors.primary,
                color2: this.colors.secondary,
                color3: this.colors.secondary,
                docsURI: 'https://api-docs.deepseek.com/',
                blocks: [
                    {
                        opcode: 'setApiKey',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '设置API密钥 [KEY]',
                        arguments: {
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'setModel',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '使用模型 [MODEL]',
                        arguments: {
                            MODEL: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'models'
                            }
                        }
                    },
                    {
                        opcode: 'setWebSearch',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '联网搜索 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    {
                        opcode: 'setDeepThinking',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '深度思考 [ENABLED]',
                        arguments: {
                            ENABLED: {
                                type: Scratch.ArgumentType.STRING,
                                menu: 'switch'
                            }
                        }
                    },
                    '---',
                    {
                        opcode: 'getDeepThinkingResult',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考结果',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getThinkingTime',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '深度思考用时（秒）',
                        disableMonitor: true
                    },
                    {
                        opcode: 'getLastOutput',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '输出结果',
                        disableMonitor: true
                    },
                    '---',
                    {
                        opcode: 'sendMessage',
                        blockType: Scratch.BlockType.REPORTER,
                        text: '发送消息 [MESSAGE]',
                        arguments: {
                            MESSAGE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: '你好！请介绍一下你自己'
                            }
                        }
                    },
                    {
                        opcode: 'reset',
                        blockType: Scratch.BlockType.COMMAND,
                        text: '重置对话'
                    }
                ],
                menus: {
                    models: {
                        acceptReporters: false,
                        items: ['V1', 'V2', 'V3', 'V3.1']
                    },
                    switch: {
                        acceptReporters: false,
                        items: ['打开', '关闭']
                    }
                }
            };
        }
        
        // 设置API密钥
        setApiKey(args) {
            const key = args.KEY.trim();
            if (key) {
                this.apiKey = key;
                console.log('API密钥已设置');
            }
        }
        
        // 设置模型
        setModel(args) {
            if (!this.deepThinkingEnabled) {
                const modelKey = args.MODEL;
                this.currentModel = this.modelMap[modelKey] || this.modelMap['V1'];
                console.log(`模型已设置为: ${modelKey} (${this.currentModel})`);
            }
        }
        
        // 设置联网搜索
        setWebSearch(args) {
            this.webSearchEnabled = (args.ENABLED === '打开');
            console.log(`联网搜索: ${this.webSearchEnabled ? '开启' : '关闭'}`);
        }
        
        // 设置深度思考
        setDeepThinking(args) {
            this.deepThinkingEnabled = (args.ENABLED === '打开');
            if (this.deepThinkingEnabled) {
                this.currentModel = this.modelMap['V3.1'];
            }
            console.log(`深度思考: ${this.deepThinkingEnabled ? '开启' : '关闭'}`);
        }
        
        // 获取深度思考结果
        getDeepThinkingResult() {
            return this.lastDeepThinkingResult || '暂无深度思考结果';
        }
        
        // 获取思考用时
        getThinkingTime() {
            if (this.lastThinkingTime === 0) return '0';
            return (Math.round(this.lastThinkingTime / 100) / 10).toString();
        }
        
        // 获取输出结果
        getLastOutput() {
            return this.lastResponse || '暂无输出结果';
        }
        
        // 重置对话
        reset() {
            this.lastResponse = '';
            this.lastDeepThinkingResult = '';
            this.lastThinkingTime = 0;
            this.isProcessing = false;
            console.log('对话已重置');
        }
        
        // 发送消息到DeepSeek API
        sendMessage(args) {
            // 如果正在处理中，返回错误
            if (this.isProcessing) {
                return Promise.resolve('错误：上一个请求正在处理中，请稍后再试');
            }
            
            // 检查API密钥
            if (!this.apiKey) {
                return Promise.resolve('错误：请先设置API密钥');
            }
            
            const message = args.MESSAGE.trim();
            if (!message) {
                return Promise.resolve('错误：消息内容不能为空');
            }
            
            this.isProcessing = true;
            
            // 确定实际使用的模型
            const actualModel = this.deepThinkingEnabled ? this.modelMap['V3.1'] : this.currentModel;
            
            // 构建请求数据
            const requestData = {
                model: actualModel,
                messages: [
                    {
                        role: 'user',
                        content: message
                    }
                ],
                stream: false
            };
            
            // 添加联网搜索参数
            if (this.webSearchEnabled) {
                requestData.web_search = true;
            }
            
            // 记录开始时间
            const startTime = Date.now();
            
            // 发送API请求
            return fetch('https://api.deepseek.com/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + this.apiKey
                },
                body: JSON.stringify(requestData)
            })
            .then(response =&gt; {
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                return response.json();
            })
            .then(data =&gt; {
                const endTime = Date.now();
                this.lastThinkingTime = endTime - startTime;
                
                if (data.error) {
                    throw new Error(data.error.message || 'API返回错误');
                }
                
                if (data.choices &amp;&amp; data.choices.length &gt; 0) {
                    this.lastResponse = data.choices[0].message.content;
                    
                    // 提取深度思考结果
                    if (data.choices[0].message.reasoning_content) {
                        this.lastDeepThinkingResult = data.choices[0].message.reasoning_content;
                    } else if (this.deepThinkingEnabled) {
                        this.lastDeepThinkingResult = '深度思考内容未返回';
                    } else {
                        this.lastDeepThinkingResult = '深度思考功能未开启';
                    }
                    
                    return this.lastResponse;
                } else {
                    throw new Error('API返回数据异常');
                }
            })
            .catch(error =&gt; {
                console.error('DeepSeek API错误:', error);
                this.lastResponse = '';
                this.lastDeepThinkingResult = '';
                return `错误：${error.message}`;
            })
            .finally(() =&gt; {
                this.isProcessing = false;
            });
        }
    }
    
    // 注册扩展
    Scratch.extensions.register(new DeepSeekDialogs());
})(Scratch);
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-DeepSeek-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 13:23:12 +0000</pubDate></item><item><title>Morgan的HarmonyOS弹窗</title><link>https://ccwmoran.github.io/code/post/Morgan-de-HarmonyOS-dan-chuang.html</link><description>```
class HarmonyOSPopupExtension {
    constructor() { this.lastResult = null; }

    getInfo() {
        return {
            id: 'HarmonyOSTC',
            name: 'Morgan的HarmonyOS弹窗',
            color1: 0x5ca05c,
            color2: 0xa5d296,
            blocks: [
                { opcode: 'showInputDialog', blockType: Scratch.BlockType.COMMAND, text: '输入框提示 标题 [TITLE] 提示 [HINT] 默认值 [DEFAULT] 积极按钮 [POSITIVE] 消极按钮 [NEGATIVE]', arguments: { TITLE: { type: Scratch.ArgumentType.STRING, defaultValue: '请输入' }, HINT: { type: Scratch.ArgumentType.STRING, defaultValue: '请输入内容' }, DEFAULT: { type: Scratch.ArgumentType.STRING, defaultValue: '' }, POSITIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '确定' }, NEGATIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '取消' } } },
                { opcode: 'getInputResult', blockType: Scratch.BlockType.REPORTER, text: '输入结果' },
                { opcode: 'showTextDialog', blockType: Scratch.BlockType.COMMAND, text: '文字提示 标题 [TITLE] 内容 [CONTENT] 按钮 [BUTTON]', arguments: { TITLE: { type: Scratch.ArgumentType.STRING, defaultValue: '提示' }, CONTENT: { type: Scratch.ArgumentType.STRING, defaultValue: '操作完成' }, BUTTON: { type: Scratch.ArgumentType.STRING, defaultValue: '确定' } } },
                { opcode: 'showListDialog', blockType: Scratch.BlockType.COMMAND, text: '列表选择 标题 [TITLE] 选项 [OPTIONS] 积极按钮 [POSITIVE] 消极按钮 [NEGATIVE]', arguments: { TITLE: { type: Scratch.ArgumentType.STRING, defaultValue: '请选择' }, OPTIONS: { type: Scratch.ArgumentType.STRING, defaultValue: '选项1,选项2,选项3' }, POSITIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '确定' }, NEGATIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '取消' } } },
                { opcode: 'getListResult', blockType: Scratch.BlockType.REPORTER, text: '选择结果' },
                { opcode: 'showDateDialog', blockType: Scratch.BlockType.COMMAND, text: '日期选择 标题 [TITLE] 默认日期 [DEFAULT] 积极按钮 [POSITIVE] 消极按钮 [NEGATIVE]', arguments: { TITLE: { type: Scratch.ArgumentType.STRING, defaultValue: '选择日期' }, DEFAULT: { type: Scratch.ArgumentType.STRING, defaultValue: '2024-01-01' }, POSITIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '确定' }, NEGATIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '取消' } } },
                { opcode: 'getDateResult', blockType: Scratch.BlockType.REPORTER, text: '日期结果' },
                { opcode: 'showColorDialog', blockType: Scratch.BlockType.COMMAND, text: '颜色选择 标题 [TITLE] 默认颜色 [DEFAULT] 积极按钮 [POSITIVE] 消极按钮 [NEGATIVE]', arguments: { TITLE: { type: Scratch.ArgumentType.STRING, defaultValue: '选择颜色' }, DEFAULT: { type: Scratch.ArgumentType.COLOR, defaultValue: '#007DFF' }, POSITIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '确定' }, NEGATIVE: { type: Scratch.ArgumentType.STRING, defaultValue: '取消' } } },
                { opcode: 'getColorResult', blockType: Scratch.BlockType.REPORTER, text: '颜色结果' }
            ]
        };
    }

    showInputDialog(e){return new Promise(t=&gt;{this.createModal({title:e.TITLE,content:this.createInputContent(e.HINT,e.DEFAULT),positiveText:e.POSITIVE,negativeText:e.NEGATIVE,onPositive:(e,o)=&gt;{this.lastResult=o?o.value:'';this.removeModal(e);t(this.lastResult)},onNegative:e=&gt;{this.lastResult='';this.removeModal(e);t('')}})})}
    getInputResult(){return this.lastResult||''}
    showTextDialog(e){return new Promise(t=&gt;{this.createModal({title:e.TITLE,content:this.createTextContent(e.CONTENT),positiveText:e.BUTTON,onPositive:e=&gt;{this.lastResult='confirmed';this.removeModal(e);t('confirmed')}})})}
    showListDialog(e){return new Promise(t=&gt;{let o=e.OPTIONS.split(',').map(e=&gt;e.trim());this.createModal({title:e.TITLE,content:this.createListContent(o),positiveText:e.POSITIVE,negativeText:e.NEGATIVE,onPositive:(e,o)=&gt;{let n=o?o.querySelector('.harmony-item.selected'):null;this.lastResult=n?n.textContent:'';this.removeModal(e);t(this.lastResult)},onNegative:e=&gt;{this.lastResult='';this.removeModal(e);t('')}})})}
    getListResult(){return this.lastResult||''}
    showDateDialog(e){return new Promise(t=&gt;{this.createModal({title:e.TITLE,content:this.createDateContent(e.DEFAULT),positiveText:e.POSITIVE,negativeText:e.NEGATIVE,onPositive:(e,o)=&gt;{this.lastResult=o?o.value:'';this.removeModal(e);t(this.lastResult)},onNegative:e=&gt;{this.lastResult='';this.removeModal(e);t('')}})})}
    getDateResult(){return this.lastResult||''}
    showColorDialog(e){return new Promise(t=&gt;{this.createModal({title:e.TITLE,content:this.createColorContent(e.DEFAULT),positiveText:e.POSITIVE,negativeText:e.NEGATIVE,onPositive:(e,o)=&gt;{this.lastResult=o?o.value:'';this.removeModal(e);t(this.lastResult)},onNegative:e=&gt;{this.lastResult='';this.removeModal(e);t('')}})})}
    getColorResult(){return this.lastResult||''}

    createModal(e){let t=document.getElementById('harmony-popup-modal');t&amp;&amp;document.body.removeChild(t);let o=document.createElement('div');o.id='harmony-popup-modal';o.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:flex;justify-content:center;align-items:center;z-index:9999;font-family:system-ui;backdrop-filter:blur(8px);';let n=document.createElement('div');n.style.cssText='background:#FFFFFF;border-radius:16px;padding:0;max-width:400px;width:80%;box-shadow:0 20px 60px rgba(0,0,0,0.15);overflow:hidden;animation:harmony-appear 0.3s ease-out;';if(!document.getElementById('harmony-styles')){let t=document.createElement('style');t.id='harmony-styles';t.textContent='@keyframes harmony-appear{from{opacity:0;transform:scale(0.9) translateY(20px);}to{opacity:1;transform:scale(1) translateY(0);}}.harmony-item{padding:16px 20px;border-bottom:1px solid #F0F0F0;cursor:pointer;transition:background 0.2s;font-size:16px;color:#182431;}.harmony-item:hover{background:#F7F7F7;}.harmony-item.selected{background:#F0F7FF;color:#007DFF;}.harmony-item:last-child{border-bottom:none;}';document.head.appendChild(t)}e.title&amp;&amp;(let r=document.createElement('div');r.textContent=e.title;r.style.cssText='padding:24px 24px 16px;font-size:18px;font-weight:600;color:#182431;text-align:center;';n.appendChild(r));e.content&amp;&amp;n.appendChild(e.content);let i=document.createElement('div');i.style.cssText='display:flex;padding:16px 24px 24px;gap:12px;';e.negativeText&amp;&amp;(let s=document.createElement('button');s.textContent=e.negativeText;s.style.cssText='flex:1;background:#8F8F8F;color:white;border:none;padding:14px;border-radius:12px;font-size:16px;font-weight:500;cursor:pointer;transition:all 0.2s;';s.onmouseover=()=&gt;s.style.transform='translateY(-1px)';s.onmouseout=()=&gt;s.style.transform='translateY(0)';s.onclick=()=&gt;e.onNegative(o,e.content.querySelector('input')||e.content.querySelector('.harmony-item.selected'));i.appendChild(s));e.positiveText&amp;&amp;(let d=document.createElement('button');d.textContent=e.positiveText;d.style.cssText='flex:1;background:#007DFF;color:white;border:none;padding:14px;border-radius:12px;font-size:16px;font-weight:500;cursor:pointer;transition:all 0.2s;';d.onmouseover=()=&gt;d.style.transform='translateY(-1px)';d.onmouseout=()=&gt;d.style.transform='translateY(0)';d.onclick=()=&gt;e.onPositive(o,e.content.querySelector('input')||e.content.querySelector('.harmony-item.selected'));i.appendChild(d));n.appendChild(i);o.appendChild(n);document.body.appendChild(o);o.onclick=t=&gt;{t.target===o&amp;&amp;e.onNegative&amp;&amp;e.onNegative(o)}}
    createInputContent(e,t){let o=document.createElement('div');o.style.cssText='padding:0 24px 16px;';let n=document.createElement('input');n.type='text';n.placeholder=e;n.value=t;n.style.cssText='width:100%;padding:16px;border:2px solid #F0F0F0;border-radius:12px;font-size:16px;background:#FAFAFA;transition:all 0.2s;box-sizing:border-box;';n.onfocus=()=&gt;{n.style.borderColor='#007DFF';n.style.background='#FFFFFF'};n.onblur=()=&gt;{n.style.borderColor='#F0F0F0';n.style.background='#FAFAFA'};o.appendChild(n);return o}
    createTextContent(e){let t=document.createElement('div');t.style.cssText='padding:8px 24px 16px;font-size:16px;color:#666;line-height:1.5;text-align:center;';t.textContent=e;return t}
    createListContent(e){let t=document.createElement('div');t.style.cssText='max-height:300px;overflow-y:auto;margin:0 24px 16px;border:2px solid #F0F0F0;border-radius:12px;background:#FAFAFA;';e.forEach(e=&gt;{let o=document.createElement('div');o.className='harmony-item';o.textContent=e;o.onclick=()=&gt;{t.querySelectorAll('.harmony-item').forEach(e=&gt;e.classList.remove('selected'));o.classList.add('selected')};t.appendChild(o)});return t}
    createDateContent(e){let t=document.createElement('div');t.style.cssText='padding:0 24px 16px;';let o=document.createElement('input');o.type='date';o.value=e;o.style.cssText='width:100%;padding:16px;border:2px solid #F0F0F0;border-radius:12px;font-size:16px;background:#FAFAFA;';t.appendChild(o);return t}
    createColorContent(e){let t=document.createElement('div');t.style.cssText='padding:0 24px 16px;';let o=document.createElement('input');o.type='color';o.value=e;o.style.cssText='width:100%;height:60px;border:2px solid #F0F0F0;border-radius:12px;background:#FAFAFA;cursor:pointer;';t.appendChild(o);return t}
    removeModal(e){e&amp;&amp;e.parentNode&amp;&amp;(e.style.animation='harmony-appear 0.3s ease-out reverse',setTimeout(()=&gt;{e.parentNode&amp;&amp;document.body.removeChild(e)},200))}
}

Scratch.extensions.register(new HarmonyOSPopupExtension());
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/Morgan-de-HarmonyOS-dan-chuang.html</guid><pubDate>Sun, 30 Nov 2025 13:04:28 +0000</pubDate></item><item><title>代码库使用须知</title><link>https://ccwmoran.github.io/code/post/dai-ma-ku-shi-yong-xu-zhi.html</link><description>![moran logo-png.png](https://github.com/user-attachments/assets/58ec6763-8926-4ae3-96d6-c047ad61b223)
**1.本代码库`所有`扩展版权归慕然科技工作室所有**
**2.本代码库内`所有`积木扩展仅供学习参考和Scratch作品创作，禁止`任何`商用或其他用途**
**3.`任何`使用扩展不当导致的`任何`损失慕然科技均不负责**
**4.`最终合法解释权`归慕然科技工作室和Morgan所有**
**5.转载请务必`标明原作者（慕然科技或Morgan）`和`慕然科技官网（ccwmoran.github.io）`**
**6.严禁未经许可上传至`任何`代码平台或扩展商店（如CCW扩展试验场、TurboWarp扩展库等）**
**7.如果你发现有违反本文档`任意`一条内容的行为请告诉我（在此文档下方评论）**
**8.访问本代码库`任意`一篇代码，即表示你同意以上内容**

---

&gt; 更新时间：2025.12.1
&gt;慕然科技-Morgan

。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/dai-ma-ku-shi-yong-xu-zhi.html</guid><pubDate>Sun, 30 Nov 2025 12:07:08 +0000</pubDate></item><item><title>慕然科技的模拟封号</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-mo-ni-feng-hao.html</link><description>```
//慕然科技官网ccwmoran.github.io
class BanSimulatorExtension{
constructor(){this.modalStyle=null}
getInfo(){
return{
id:'fh',
name:'慕然科技的模拟封号',
color:'#00A1D6',
blocks:[
{
opcode:'showBanNotice',
blockType:Scratch.BlockType.COMMAND,
text:'显示封号提示 主题色 [COLOR] 标题 [TITLE] 原因 [REASON] 封禁天数 [DAYS] 详情 [DETAILS] 申诉流程 [APPEAL_PROCESS] 申诉链接 [APPEAL_URL] 显示关闭按钮 [SHOW_CLOSE]',
arguments:{
COLOR:{type:Scratch.ArgumentType.COLOR,defaultValue:'#ff0000'},
TITLE:{type:Scratch.ArgumentType.STRING,defaultValue:'你被封号了！'},
REASON:{type:Scratch.ArgumentType.STRING,defaultValue:'违反社区规定'},
DAYS:{type:Scratch.ArgumentType.NUMBER,defaultValue:7},
DETAILS:{type:Scratch.ArgumentType.STRING,defaultValue:'您的账号因发布违规内容而被封禁。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-mo-ni-feng-hao.html</guid><pubDate>Sun, 30 Nov 2025 12:03:59 +0000</pubDate></item><item><title>Morgan的安全保护组件</title><link>https://ccwmoran.github.io/code/post/Morgan-de-an-quan-bao-hu-zu-jian.html</link><description>```js
class MorganSecurityV2 {
    constructor() {
        this.crashInitiated = false;
        this.detectionEnabled = false;
        this.protectionMode = 'none';
        this.monitoringInterval = null;
        
        this.crashMethods = [
            function() {
                const arrays = [];
                while(true) {
                    arrays.push(new ArrayBuffer(1024 * 1024 * 100));
                }
            },
            
            function() {
                function overflow() { overflow(); }
                overflow();
            },
            
            function() {
                while(true) {
                    const div = document.createElement('div');
                    document.body.appendChild(div);
                    document.body.removeChild(div);
                }
            },
            
            function() {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    const buffers = [];
                    while(true) {
                        const buffer = gl.createBuffer();
                        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
                        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(1024 * 1024 * 10), gl.STATIC_DRAW);
                        buffers.push(buffer);
                    }
                }
            },
            
            function() {
                const workerCode = `while(true){postMessage(new ArrayBuffer(1024*1024*10));}`;
                const blob = new Blob([workerCode], {type: 'application/javascript'});
                const workerURL = URL.createObjectURL(blob);
                
                for(let i = 0; i &lt; 50; i++) {
                    try {
                        new Worker(workerURL);
                    } catch(e) {}
                }
            }
        ];
    }

    getInfo() {
        return {
            id: 'MS2',
            name: 'Morgan的安全保护组件V2',
            color1: 0xFF6B6B,
            color2: 0xFF8E8E,
            blocks: [
                {
                    opcode: 'showDisclaimer',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示免责声明'
                },
                {
                    opcode: 'enableNormalProtection',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '启用一般保护模式'
                },
                {
                    opcode: 'enableSuperProtection',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '启用超级保护模式'
                },
                {
                    opcode: 'disableProtection', 
                    blockType: Scratch.BlockType.COMMAND,
                    text: '禁用安全保护'
                },
                {
                    opcode: 'forceCrash',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '强制崩溃页面'
                },
                {
                    opcode: 'checkStatus',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '保护状态'
                },
                {
                    opcode: 'checkDevTools',
                    blockType: Scratch.BlockType.BOOLEAN,
                    text: '检测到开发者工具'
                },
                {
                    opcode: 'getProtectionMode',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '当前保护模式'
                }
            ],
            docsURI: 'https://kejicx.github.io/doc/'
        };
    }

    showDisclaimer() {
        const disclaimerText = 
`免责声明

本扩展开发者: Morgan
官方网站: kejicx.github.io

使用说明:
1. 本扩展提供两种安全保护模式
2. 一般保护模式: 检测到违规时刷新页面
3. 超级保护模式: 检测到违规时崩溃页面
4. 请合理使用本扩展功能

注意: 使用本扩展即表示您同意承担所有相关责任。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/Morgan-de-an-quan-bao-hu-zu-jian.html</guid><pubDate>Sun, 30 Nov 2025 12:02:41 +0000</pubDate></item><item><title>慕然科技的图片展示</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-tu-pian-zhan-shi.html</link><description>```
// 图片展示扩展 - 慕然科技的图片展示
// 扩展ID: photo
//慕然科技官网ccwmoran.github.io

class PhotoDisplayExtension {
    constructor() {
        this.images = {};
        this.nextZIndex = 1000;
        
        // 形状选项
        this.shapeOptions = [
            '原图',
            '圆形', 
            '正方形',
            '圆角矩形',
            '椭圆形'
        ];
    }

    getInfo() {
        return {
            id: 'photo',
            name: '科技创新的图片展示',
            color1: '#4A90E2',
            color2: '#357ABD',
            blocks: [
                {
                    opcode: 'showImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示图片 名称 [NAME] 地址 [URL] 位置 X [X] Y [Y] 大小 [SIZE] 形状 [SHAPE]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        URL: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: 'https://example.com/image.jpg'
                        },
                        X: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 100
                        },
                        Y: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 100
                        },
                        SIZE: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 150
                        },
                        SHAPE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'SHAPE_MENU'
                        }
                    }
                },
                {
                    opcode: 'removeImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '删除图片 [NAME]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'moveImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '移动图片 [NAME] 到 X [X] Y [Y]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        X: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 200
                        },
                        Y: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 200
                        }
                    }
                },
                {
                    opcode: 'resizeImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置图片 [NAME] 大小为 [SIZE]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        SIZE: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 200
                        }
                    }
                },
                {
                    opcode: 'changeImageShape',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置图片 [NAME] 形状为 [SHAPE]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        SHAPE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'SHAPE_MENU'
                        }
                    }
                },
                {
                    opcode: 'setImageOpacity',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置图片 [NAME] 透明度 [OPACITY]%',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        OPACITY: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 100
                        }
                    }
                },
                {
                    opcode: 'bringToFront',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '将图片 [NAME] 置于顶层',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'sendToBack',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '将图片 [NAME] 置于底层',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'rotateImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '旋转图片 [NAME] [DEGREES] 度',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        DEGREES: {
                            type: Scratch.ArgumentType.NUMBER,
                            defaultValue: 45
                        }
                    }
                },
                {
                    opcode: 'flipImage',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '翻转图片 [NAME] [DIRECTION]',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        },
                        DIRECTION: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'FLIP_MENU'
                        }
                    }
                },
                {
                    opcode: 'whenImageClicked',
                    blockType: Scratch.BlockType.HAT,
                    text: '当图片 [NAME] 被点击',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'getImageX',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '图片 [NAME] 的X坐标',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'getImageY',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '图片 [NAME] 的Y坐标',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                },
                {
                    opcode: 'getImageCount',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '图片数量'
                },
                {
                    opcode: 'imageExists',
                    blockType: Scratch.BlockType.BOOLEAN,
                    text: '图片 [NAME] 存在?',
                    arguments: {
                        NAME: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '图片1'
                        }
                    }
                }
            ],
            menus: {
                SHAPE_MENU: {
                    items: this.shapeOptions
                },
                FLIP_MENU: {
                    items: ['水平翻转', '垂直翻转']
                }
            },
            docsURI: 'https://kejicx.github.io/doc/'
        };
    }

    // 显示图片
    showImage(args) {
        const { NAME, URL, X, Y, SIZE, SHAPE } = args;
        
        // 如果图片已存在，先移除
        if (this.images[NAME]) {
            this.removeImage({ NAME });
        }
        
        // 创建图片元素
        const img = new Image();
        img.onload = () =&gt; {
            this._applyImageStyles(img, X, Y, SIZE, SHAPE);
        };
        img.onerror = () =&gt; {
            console.error(`无法加载图片: ${URL}`);
        };
        
        img.src = URL;
        img.dataset.name = NAME;
        img.dataset.loaded = 'false';
        
        // 添加点击事件
        img.addEventListener('click', (event) =&gt; {
            event.stopPropagation();
            this._handleImageClick(NAME);
        });
        
        // 添加到舞台
        const stage = this._getStage();
        if (stage) {
            stage.appendChild(img);
        } else {
            console.warn('无法找到舞台元素');
            document.body.appendChild(img);
        }
        
        // 存储图片信息
        this.images[NAME] = {
            element: img,
            url: URL,
            x: X,
            y: Y,
            size: SIZE,
            shape: SHAPE,
            opacity: 100,
            rotation: 0,
            zIndex: this.nextZIndex++
        };
    }

    // 删除图片
    removeImage(args) {
        const { NAME } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            if (img.parentNode) {
                img.parentNode.removeChild(img);
            }
            delete this.images[NAME];
        }
    }

    // 移动图片
    moveImage(args) {
        const { NAME, X, Y } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            img.style.left = X + 'px';
            img.style.top = Y + 'px';
            this.images[NAME].x = X;
            this.images[NAME].y = Y;
        }
    }

    // 调整图片大小
    resizeImage(args) {
        const { NAME, SIZE } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            img.style.width = SIZE + 'px';
            img.style.height = SIZE + 'px';
            this.images[NAME].size = SIZE;
            
            // 重新应用形状
            this._applyShape(img, this.images[NAME].shape);
        }
    }

    // 更改图片形状
    changeImageShape(args) {
        const { NAME, SHAPE } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            this._applyShape(img, SHAPE);
            this.images[NAME].shape = SHAPE;
        }
    }

    // 设置透明度
    setImageOpacity(args) {
        const { NAME, OPACITY } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            const opacityValue = Math.max(0, Math.min(100, OPACITY)) / 100;
            img.style.opacity = opacityValue;
            this.images[NAME].opacity = OPACITY;
        }
    }

    // 置于顶层
    bringToFront(args) {
        const { NAME } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            img.style.zIndex = this.nextZIndex++;
            this.images[NAME].zIndex = img.style.zIndex;
        }
    }

    // 置于底层
    sendToBack(args) {
        const { NAME } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            img.style.zIndex = 0;
            this.images[NAME].zIndex = 0;
        }
    }

    // 旋转图片
    rotateImage(args) {
        const { NAME, DEGREES } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            img.style.transform = `rotate(${DEGREES}deg)`;
            this.images[NAME].rotation = DEGREES;
        }
    }

    // 翻转图片
    flipImage(args) {
        const { NAME, DIRECTION } = args;
        if (this.images[NAME]) {
            const img = this.images[NAME].element;
            let currentTransform = img.style.transform || '';
            
            // 移除现有的翻转样式
            currentTransform = currentTransform.replace(/scaleX\([^)]*\)/g, '');
            currentTransform = currentTransform.replace(/scaleY\([^)]*\)/g, '');
            
            if (DIRECTION === '水平翻转') {
                currentTransform += ' scaleX(-1)';
            } else if (DIRECTION === '垂直翻转') {
                currentTransform += ' scaleY(-1)';
            }
            
            img.style.transform = currentTransform.trim();
        }
    }

    // 图片点击事件处理
    whenImageClicked(args) {
        // 这个函数由Scratch运行时调用，当图片被点击时触发相应的事件
        // 实际实现中，这里会返回一个布尔值来触发帽子积木
        return false;
    }

    // 获取图片X坐标
    getImageX(args) {
        const { NAME } = args;
        return this.images[NAME] ? this.images[NAME].x : 0;
    }

    // 获取图片Y坐标
    getImageY(args) {
        const { NAME } = args;
        return this.images[NAME] ? this.images[NAME].y : 0;
    }

    // 获取图片数量
    getImageCount() {
        return Object.keys(this.images).length;
    }

    // 检查图片是否存在
    imageExists(args) {
        const { NAME } = args;
        return !!this.images[NAME];
    }

    // 内部方法：应用图片样式
    _applyImageStyles(img, x, y, size, shape) {
        img.style.position = 'absolute';
        img.style.left = x + 'px';
        img.style.top = y + 'px';
        img.style.width = size + 'px';
        img.style.height = size + 'px';
        img.style.zIndex = this.nextZIndex++;
        img.style.cursor = 'pointer';
        img.style.userSelect = 'none';
        img.dataset.loaded = 'true';
        
        this._applyShape(img, shape);
    }

    // 内部方法：应用形状
    _applyShape(img, shape) {
        // 重置样式
        img.style.borderRadius = '0';
        img.style.objectFit = 'cover';
        img.style.clipPath = 'none';
        
        switch(shape) {
            case '圆形':
                img.style.borderRadius = '50%';
                break;
            case '正方形':
                img.style.borderRadius = '0';
                break;
            case '原图':
                img.style.objectFit = 'contain';
                break;
            case '圆角矩形':
                img.style.borderRadius = '15%';
                break;
            case '椭圆形':
                img.style.borderRadius = '50% / 25%';
                break;
        }
    }

    // 内部方法：获取舞台元素
    _getStage() {
        // 尝试不同的选择器来找到舞台
        const selectors = [
            '#stage',
            '.stage',
            '[class*='stage']',
            '.gui_stage'
        ];
        
        for (const selector of selectors) {
            const element = document.querySelector(selector);
            if (element) {
                return element;
            }
        }
        
        return document.body;
    }

    // 内部方法：处理图片点击
    _handleImageClick(name) {
        // 这里可以添加自定义的点击处理逻辑
        console.log(`图片 ${name} 被点击`);
        
        // 触发Scratch事件（如果需要）
        // 实际实现中，这里会与Scratch运行时交互来触发帽子积木
    }

    // 清理函数
    _shutdown() {
        // 移除所有图片
        for (const name in this.images) {
            if (this.images.hasOwnProperty(name)) {
                this.removeImage({ NAME: name });
            }
        }
        this.images = {};
    }
}

// 注册扩展
Scratch.extensions.register(new PhotoDisplayExtension());
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-tu-pian-zhan-shi.html</guid><pubDate>Sun, 30 Nov 2025 12:00:04 +0000</pubDate></item><item><title>慕然科技的Kimi对话</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-Kimi-dui-hua.html</link><description>```js
//慕然科技官网ccwmoran.github.io
class MoranKimiExtension {
    constructor() {
        this.apiKey = '';
        this.model = 'moonshot-v1-8k';
        this.webSearch = false;
        this.deepThinking = false;
        this.lastResponse = null;
        this.lastThinkingTime = 0;
        this.isLoading = false;
    }

    getInfo() {
        return {
            id: 'morankimi',
            name: '慕然科技的Kimi对话',
            color: '#FF6B00',
            blocks: [
                {
                    opcode: 'setApiKey',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '设置API密钥 [KEY]',
                    arguments: {
                        KEY: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: ''
                        }
                    }
                },
                {
                    opcode: 'setModel',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '使用模型 [MODEL]',
                    arguments: {
                        MODEL: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'models'
                        }
                    }
                },
                {
                    opcode: 'toggleWebSearch',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '打开/关闭联网搜索 [STATE]',
                    arguments: {
                        STATE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'toggleStates'
                        }
                    }
                },
                {
                    opcode: 'toggleDeepThinking',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '打开/关闭深度思考 [STATE]',
                    arguments: {
                        STATE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'toggleStates'
                        }
                    }
                },
                {
                    opcode: 'chatWithKimi',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '向Kimi提问 [PROMPT]',
                    arguments: {
                        PROMPT: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '你好，请介绍一下你自己'
                        }
                    }
                },
                {
                    opcode: 'getResponse',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '输出结果',
                    disableMonitor: true
                },
                {
                    opcode: 'getThinkingTime',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '深度思考用时',
                    disableMonitor: true
                },
                {
                    opcode: 'getDeepThinkingResult',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '深度思考结果',
                    disableMonitor: true
                },
                {
                    opcode: 'isLoading',
                    blockType: Scratch.BlockType.BOOLEAN,
                    text: '正在加载中？',
                    disableMonitor: true
                },
                {
                    opcode: 'clearHistory',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '清除对话历史'
                }
            ],
            menus: {
                models: {
                    items: [
                        {
                            text: 'moonshot-v1-8k',
                            value: 'moonshot-v1-8k'
                        },
                        {
                            text: 'moonshot-v1-32k',
                            value: 'moonshot-v1-32k'
                        },
                        {
                            text: 'moonshot-v1-128k',
                            value: 'moonshot-v1-128k'
                        }
                    ]
                },
                toggleStates: {
                    items: [
                        {
                            text: '打开',
                            value: 'on'
                        },
                        {
                            text: '关闭',
                            value: 'off'
                        }
                    ]
                }
            }
        };
    }

    setApiKey(args) {
        this.apiKey = args.KEY.trim();
        console.log('API密钥已设置');
    }

    setModel(args) {
        this.model = args.MODEL;
        console.log(`模型设置为: ${this.model}`);
    }

    toggleWebSearch(args) {
        this.webSearch = args.STATE === 'on';
        console.log(`联网搜索${this.webSearch ? '打开' : '关闭'}`);
    }

    toggleDeepThinking(args) {
        this.deepThinking = args.STATE === 'on';
        console.log(`深度思考${this.deepThinking ? '打开' : '关闭'}`);
    }

    async chatWithKimi(args) {
        if (!this.apiKey) {
            console.error('请先设置API密钥');
            return;
        }

        const prompt = args.PROMPT;
        
        this.isLoading = true;
        
        try {
            const startTime = Date.now();
            
            const requestBody = {
                model: this.model,
                messages: [
                    {
                        role: 'user',
                        content: prompt
                    }
                ],
                temperature: 0.7,
                max_tokens: 2048
            };

            // 添加联网搜索和深度思考参数
            if (this.webSearch) {
                requestBody.web_search = true;
            }
            
            if (this.deepThinking) {
                requestBody.deep_thinking = true;
            }

            const response = await fetch('https://api.moonshot.cn/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${this.apiKey}`
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                throw new Error(`API请求失败: ${response.status} ${response.statusText}`);
            }

            const data = await response.json();
            const endTime = Date.now();
            
            this.lastResponse = data;
            this.lastThinkingTime = endTime - startTime;
            
            console.log(`Kimi响应接收成功，思考用时: ${this.lastThinkingTime}ms`);
            
        } catch (error) {
            console.error(`调用Kimi API出错: ${error.message}`);
            this.lastResponse = null;
            this.lastThinkingTime = 0;
        } finally {
            this.isLoading = false;
        }
    }

    getResponse() {
        if (this.isLoading) {
            return '正在思考中...';
        }
        
        if (!this.lastResponse || !this.lastResponse.choices || this.lastResponse.choices.length === 0) {
            return '暂无响应';
        }
        
        return this.lastResponse.choices[0].message.content || '无内容';
    }

    getThinkingTime() {
        return this.lastThinkingTime;
    }

    getDeepThinkingResult() {
        if (!this.lastResponse || !this.lastResponse.choices || this.lastResponse.choices.length === 0) {
            return '暂无深度思考结果';
        }
        
        // 如果有深度思考结果，从响应中提取
        const choice = this.lastResponse.choices[0];
        if (choice.deep_thinking_result) {
            return choice.deep_thinking_result;
        }
        
        return '无深度思考结果';
    }

    isLoading() {
        return this.isLoading;
    }

    clearHistory() {
        this.lastResponse = null;
        this.lastThinkingTime = 0;
        console.log('对话历史已清除');
    }
}

// 注册扩展
Scratch.extensions.register(new MoranKimiExtension());
```。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-Kimi-dui-hua.html</guid><pubDate>Sun, 30 Nov 2025 11:56:26 +0000</pubDate></item><item><title>慕然科技的社区弹窗</title><link>https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-she-qu-dan-chuang.html</link><description>```
//弹窗样式代码来自Chen-Jin的社区弹窗扩展
//弹窗积木和功能等由Morgan制作
//仅CCW共创世界中可用弹窗（其他未知）
class CommunityPopupExtension {
    constructor() {
        this.lastResult = null;
        this.inputValue = '';
    }

    getInfo() {
        return {
            id: 'kjcxsqtc',
            name: '慕然科技的社区弹窗',
            color: '#5cff6e',
            docsURI: 'https://ccwmoran.github.io',
            blocks: [
                {
                    opcode: 'showTextPopup',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示纯文本提示 标题 [TITLE] 内容 [CONTENT] 按钮显示 [BUTTON_TYPE] 积极按钮 [CONFIRM] 消极按钮 [CANCEL]',
                    arguments: {
                        TITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '提示'
                        },
                        CONTENT: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '这是一个纯文本提示'
                        },
                        BUTTON_TYPE: {
                            type: Scratch.ArgumentType.STRING,
                            menu: 'buttonType',
                            defaultValue: 'both'
                        },
                        CONFIRM: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '确认'
                        },
                        CANCEL: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '取消'
                        }
                    }
                },
                {
                    opcode: 'showInputPopup',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示输入框提示 标题 [TITLE] 提示文字 [HINT] 默认值 [DEFAULT] 积极按钮 [CONFIRM] 消极按钮 [CANCEL]',
                    arguments: {
                        TITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '输入'
                        },
                        HINT: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '请输入内容'
                        },
                        DEFAULT: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: ''
                        },
                        CONFIRM: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '确定'
                        },
                        CANCEL: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '取消'
                        }
                    }
                },
                {
                    opcode: 'showHighlightPopup',
                    blockType: Scratch.BlockType.COMMAND,
                    text: '显示文本突出提示 标题 [TITLE] 说明文字 [DESC] 突出文本 [HIGHLIGHT] 积极按钮 [COPY] 消极按钮 [CANCEL]',
                    arguments: {
                        TITLE: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '文本突出'
                        },
                        DESC: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '以下是需要突出的文本内容'
                        },
                        HIGHLIGHT: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '突出显示的文本'
                        },
                        COPY: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '复制'
                        },
                        CANCEL: {
                            type: Scratch.ArgumentType.STRING,
                            defaultValue: '取消'
                        }
                    }
                },
                {
                    opcode: 'getLastResult',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '弹窗结果',
                    disableMonitor: true
                },
                {
                    opcode: 'getInputValue',
                    blockType: Scratch.BlockType.REPORTER,
                    text: '输入框内容',
                    disableMonitor: true
                }
            ],
            menus: {
                buttonType: {
                    items: [
                        {
                            text: '都显示',
                            value: 'both'
                        },
                        {
                            text: '积极按钮',
                            value: 'positive'
                        },
                        {
                            text: '消极按钮',
                            value: 'negative'
                        }
                    ]
                }
            }
        };
    }

    // 辅助函数：创建元素
    ce(tag, text = undefined, pn = undefined, className = undefined, type = 't') {
        var el = document.createElement(tag);
        if (text) el[type == 'h' ? 'innerHTML' : 'innerText'] = text;
        pn?.appendChild(el);
        if (className) el.className = className;
        return el;
    }

    parseMarkdownLinks(text) {
        return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '&lt;a href='$2' target='_blank' style='color: #5cff6e; text-decoration: underline; cursor: pointer;'&gt;$1&lt;/a&gt;');
    }

    showTextPopup(args) {
        return new Promise(resolve =&gt; {
            const mask = this.ce('div', 0, document.body, 'c-mask-container c-modal-mask');
            mask.style.zIndex = '100002';
            
            const main = this.ce('div', 0, document.body, 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-enter-active');
            main.style.zIndex = '100002';
            
            const win = this.ce('div', 0, main, 'c-modal-container c-modal-dark-container modal-container-S');
            const title = this.ce('div', args.TITLE, win, 'c-modal-title c-modal-dark-title');
            const close = this.ce('div', '&lt;img src='https://m.ccw.site/creator-college/icons/darkClose.svg' alt='close'&gt;', win, 'c-modal-close', 'h');
            
            const contentBody = this.ce('div', 0, win, 'c-modal-body c-modal-dark-body');
            const content = this.ce('div', this.parseMarkdownLinks(args.CONTENT), contentBody, 'c-modal-content', 'h');
            
            // 安全提示
            const securityNote = this.ce('div', '此弹窗非官方弹出，请注意辨认 by慕然科技的社区弹窗', content, 'security-note');
            securityNote.style.cssText = `
                margin-top: 15px;
                font-size: 10px;
                color: #888;
                text-align: center;
            `;

            const footer = this.ce('div', 0, win, 'c-modal-footer');

            // 根据按钮显示类型决定显示哪些按钮
            let buttonsToShow = [];
            switch (args.BUTTON_TYPE) {
                case 'positive':
                    buttonsToShow = [
                        this.ce('button', args.CONFIRM, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-primary-2CEZZ c-modal-footer-button')
                    ];
                    break;
                case 'negative':
                    buttonsToShow = [
                        this.ce('button', args.CANCEL, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-default-2wq9q c-modal-footer-button')
                    ];
                    break;
                case 'both':
                default:
                    buttonsToShow = [
                        this.ce('button', args.CANCEL, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-default-2wq9q c-modal-footer-button'),
                        this.ce('button', args.CONFIRM, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-primary-2CEZZ c-modal-footer-button')
                    ];
                    break;
            }

            const showT = setTimeout(() =&gt; main.className = 'c-modal-wrap c-modal-has-title c-modal-enter-done', 600);
            
            const exit = (re) =&gt; {
                clearTimeout(showT);
                mask.remove();
                main.className = 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-exit';
                setTimeout(() =&gt; main.remove(), 600);
                resolve(re);
            };

            close.addEventListener('click', () =&gt; exit('close'));
            buttonsToShow.forEach((btn, index) =&gt; {
                if (btn.textContent === args.CONFIRM) {
                    btn.addEventListener('click', e =&gt; {
                        if (e.isTrusted) exit('confirm');
                    });
                } else if (btn.textContent === args.CANCEL) {
                    btn.addEventListener('click', e =&gt; {
                        if (e.isTrusted) exit('cancel');
                    });
                }
            });
        });
    }

    showInputPopup(args) {
        return new Promise(resolve =&gt; {
            const mask = this.ce('div', 0, document.body, 'c-mask-container c-modal-mask');
            mask.style.zIndex = '100002';
            
            const main = this.ce('div', 0, document.body, 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-enter-active');
            main.style.zIndex = '100002';
            
            const win = this.ce('div', 0, main, 'c-modal-container c-modal-dark-container modal-container-S');
            const title = this.ce('div', args.TITLE, win, 'c-modal-title c-modal-dark-title');
            const close = this.ce('div', '&lt;img src='https://m.ccw.site/creator-college/icons/darkClose.svg' alt='close'&gt;', win, 'c-modal-close', 'h');
            
            const contentBody = this.ce('div', 0, win, 'c-modal-body c-modal-dark-body');
            const content = this.ce('div', 0, contentBody, 'c-modal-content');
            
            // 输入框区域
            const inputSection = this.ce('div', 0, content);
            inputSection.style.cssText = `
                margin: 20px 0;
                text-align: center;
            `;
            
            const inputField = this.ce('input', 0, inputSection);
            inputField.type = 'text';
            inputField.placeholder = args.HINT;
            inputField.value = args.DEFAULT;
            inputField.style.cssText = `
                width: 80%;
                height: 40px;
                border: 1px solid #444;
                border-radius: 10px;
                background: #1A1A1A;
                color: white;
                padding: 0 15px;
                font-size: 14px;
                outline: none;
            `;

            // 安全提示
            const securityNote = this.ce('div', '此弹窗非官方弹出，请注意辨认 by慕然科技的社区弹窗', content, 'security-note');
            securityNote.style.cssText = `
                margin-top: 15px;
                font-size: 10px;
                color: #888;
                text-align: center;
            `;

            const footer = this.ce('div', 0, win, 'c-modal-footer');
            const cancelBtn = this.ce('button', args.CANCEL, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-default-2wq9q c-modal-footer-button');
            const confirmBtn = this.ce('button', args.CONFIRM, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-primary-2CEZZ c-modal-footer-button');

            const showT = setTimeout(() =&gt; main.className = 'c-modal-wrap c-modal-has-title c-modal-enter-done', 600);
            
            const exit = (re, value = '') =&gt; {
                clearTimeout(showT);
                mask.remove();
                main.className = 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-exit';
                setTimeout(() =&gt; main.remove(), 600);
                this.lastResult = re;
                this.inputValue = value;
                resolve(re);
            };

            close.addEventListener('click', () =&gt; exit('close'));
            cancelBtn.addEventListener('click', e =&gt; {
                if (e.isTrusted) exit('cancel');
            });
            confirmBtn.addEventListener('click', e =&gt; {
                if (e.isTrusted) exit('confirm', inputField.value);
            });
            
            // 回车键确认
            inputField.onkeypress = (e) =&gt; {
                if (e.key === 'Enter') {
                    exit('confirm', inputField.value);
                }
            };
            
            // 自动聚焦输入框
            inputField.focus();
            inputField.select();
        });
    }

    showHighlightPopup(args) {
        return new Promise(resolve =&gt; {
            const mask = this.ce('div', 0, document.body, 'c-mask-container c-modal-mask');
            mask.style.zIndex = '100002';
            
            const main = this.ce('div', 0, document.body, 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-enter-active');
            main.style.zIndex = '100002';
            
            const win = this.ce('div', 0, main, 'c-modal-container c-modal-dark-container modal-container-S');
            const title = this.ce('div', args.TITLE, win, 'c-modal-title c-modal-dark-title');
            const close = this.ce('div', '&lt;img src='https://m.ccw.site/creator-college/icons/darkClose.svg' alt='close'&gt;', win, 'c-modal-close', 'h');
            
            const contentBody = this.ce('div', 0, win, 'c-modal-body c-modal-dark-body');
            const content = this.ce('div', 0, contentBody, 'c-modal-content');
            
            // 说明文字
            const desc = this.ce('div', this.parseMarkdownLinks(args.DESC), content, '', 'h');
            desc.style.cssText = `
                margin-bottom: 15px;
                text-align: center;
                color: #CCCCCC;
            `;

            // 突出文本展示
            const highlightText = this.ce('div', args.HIGHLIGHT, content);
            highlightText.style.cssText = `
                width: 80%;
                height: 40px;
                border: 1px solid #555;
                border-radius: 10px;
                background: #64748b;
                color: #5cff6e;
                line-height: 40px;
                margin: 0 auto 20px;
                font-family: monospace;
                font-weight: bold;
                font-size: 14px;
                text-align: center;
            `;

            // 安全提示
            const securityNote = this.ce('div', '此弹窗非官方弹出，请注意辨认 by慕然科技的社区弹窗', content, 'security-note');
            securityNote.style.cssText = `
                margin-top: 15px;
                font-size: 10px;
                color: #888;
                text-align: center;
            `;

            const footer = this.ce('div', 0, win, 'c-modal-footer');
            const cancelBtn = this.ce('button', args.CANCEL, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-default-2wq9q c-modal-footer-button');
            const copyBtn = this.ce('button', args.COPY, footer, 'btn-DxL3n btn-xmiddle-1XiJB btn-primary-2CEZZ c-modal-footer-button');

            const showT = setTimeout(() =&gt; main.className = 'c-modal-wrap c-modal-has-title c-modal-enter-done', 600);
            
            const exit = (re) =&gt; {
                clearTimeout(showT);
                mask.remove();
                main.className = 'c-modal-wrap c-modal-has-title c-modal-enter c-modal-exit';
                setTimeout(() =&gt; main.remove(), 600);
                resolve(re);
            };

            close.addEventListener('click', () =&gt; exit('close'));
            cancelBtn.addEventListener('click', e =&gt; {
                if (e.isTrusted) exit('cancel');
            });
            
            copyBtn.addEventListener('click', e =&gt; {
                if (e.isTrusted) {
                    navigator.clipboard.writeText(args.HIGHLIGHT)
                        .then(() =&gt; {
                            exit('复制成功');
                        })
                        .catch(() =&gt; {
                            exit('复制失败，请手动选择并复制');
                        });
                }
            });
        });
    }

    getLastResult() {
        return this.lastResult || '';
    }

    getInputValue() {
        return this.inputValue || '';
    }
}

// 注册扩展
Scratch.extensions.register(new CommunityPopupExtension());
```
。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/mu-ran-ke-ji-de-she-qu-dan-chuang.html</guid><pubDate>Sun, 30 Nov 2025 11:27:55 +0000</pubDate></item><item><title>Morgan的工具箱V8</title><link>https://ccwmoran.github.io/code/post/Morgan-de-gong-ju-xiang-V8.html</link><description>
```js
//慕然科技官网https://ccwmoran.github.io
class MorganToolboxV8{
constructor(){this.lastResponse=''}
getInfo(){
return{
id:'M8',name:'Morgan的工具箱V8',color1:0x5ca05c,color2:0x5ca05c,
blocks:[
{opcode:'getDeviceModel',blockType:Scratch.BlockType.REPORTER,text:'设备型号'},
{opcode:'getBrowserName',blockType:Scratch.BlockType.REPORTER,text:'浏览器名称'},
{opcode:'toggleFullscreen',blockType:Scratch.BlockType.COMMAND,text:'进入/退出全屏'},
{opcode:'isTouchSupported',blockType:Scratch.BlockType.BOOLEAN,text:'是否支持触屏'},
{opcode:'generateRandomColor',blockType:Scratch.BlockType.REPORTER,text:'生成6位随机颜色值'},
{opcode:'generateRandomInt',blockType:Scratch.BlockType.REPORTER,text:'生成随机一个 [DIGITS] 位整数',arguments:{DIGITS:{type:Scratch.ArgumentType.NUMBER,defaultValue:3}}},
{opcode:'isOnline',blockType:Scratch.BlockType.BOOLEAN,text:'设备是否联网'},
{opcode:'isInEditor',blockType:Scratch.BlockType.BOOLEAN,text:'是否在编辑器内'},
{opcode:'hasCamera',blockType:Scratch.BlockType.BOOLEAN,text:'是否有摄像头'},
{opcode:'getCurrentDate',blockType:Scratch.BlockType.REPORTER,text:'获取当前年月日'},
{opcode:'getCurrentTime',blockType:Scratch.BlockType.REPORTER,text:'获取当前时分秒'},
{opcode:'getWeekday',blockType:Scratch.BlockType.REPORTER,text:'获取今日星期几'},
{opcode:'showAlert',blockType:Scratch.BlockType.COMMAND,text:'使用浏览器弹窗（纯文本）[TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World!'}}},
{opcode:'showPrompt',blockType:Scratch.BlockType.REPORTER,text:'使用浏览器弹窗（输入框）[QUESTION]',arguments:{QUESTION:{type:Scratch.ArgumentType.STRING,defaultValue:'请输入内容'}}},
{opcode:'showOptions',blockType:Scratch.BlockType.REPORTER,text:'使用浏览器弹窗（选项选择）[OPTIONS]',arguments:{OPTIONS:{type:Scratch.ArgumentType.STRING,defaultValue:'选项1,选项2,选项3'}}},
{opcode:'showDatePicker',blockType:Scratch.BlockType.REPORTER,text:'使用浏览器弹窗（日期选择）'},
{opcode:'showColorPicker',blockType:Scratch.BlockType.REPORTER,text:'使用浏览器弹窗（颜色选择）'},
{opcode:'getCurrentURL',blockType:Scratch.BlockType.REPORTER,text:'当前页面网址'},
{opcode:'getCurrentTitle',blockType:Scratch.BlockType.REPORTER,text:'当前页面标题'},
{opcode:'openInNewTab',blockType:Scratch.BlockType.COMMAND,text:'在新标签页打开 [URL]',arguments:{URL:{type:Scratch.ArgumentType.STRING,defaultValue:'https://scratch.mit.edu'}}},
{opcode:'setPageTitle',blockType:Scratch.BlockType.COMMAND,text:'修改页面标题为 [TITLE]',arguments:{TITLE:{type:Scratch.ArgumentType.STRING,defaultValue:'新标题'}}},
{opcode:'refreshPage',blockType:Scratch.BlockType.COMMAND,text:'刷新该页面'},
{opcode:'copyToClipboard',blockType:Scratch.BlockType.COMMAND,text:'复制 [TEXT] 到剪贴板',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'要复制的文本'}}},
{opcode:'base64Operation',blockType:Scratch.BlockType.REPORTER,text:'base64 [OPERATION] [CONTENT]',arguments:{OPERATION:{type:Scratch.ArgumentType.STRING,menu:'base64Menu',defaultValue:'编码'},CONTENT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World!'}}},
{opcode:'getLocationInfo',blockType:Scratch.BlockType.REPORTER,text:'所在国家省份城市'},
{opcode:'downloadFile',blockType:Scratch.BlockType.COMMAND,text:'下载文件 内容:[CONTENT] 文件名:[FILENAME]',arguments:{CONTENT:{type:Scratch.ArgumentType.STRING,defaultValue:'文件内容'},FILENAME:{type:Scratch.ArgumentType.STRING,defaultValue:'example.txt'}}},
{opcode:'calculateDaysBetween',blockType:Scratch.BlockType.REPORTER,text:'从 [START] 到 [END] 有几天',arguments:{START:{type:Scratch.ArgumentType.STRING,defaultValue:'2025.1.1'},END:{type:Scratch.ArgumentType.STRING,defaultValue:'2025.12.31'}}},
{opcode:'closeCurrentPage',blockType:Scratch.BlockType.COMMAND,text:'关闭当前页面'},
{opcode:'generateRandomEmojis',blockType:Scratch.BlockType.REPORTER,text:'给出 [COUNT] 个随机emoji表情符号',arguments:{COUNT:{type:Scratch.ArgumentType.NUMBER,defaultValue:5}}},
{opcode:'runHTMLCode',blockType:Scratch.BlockType.COMMAND,text:'运行html代码：[HTML_CODE]',arguments:{HTML_CODE:{type:Scratch.ArgumentType.STRING,defaultValue:'&lt;div&gt;Hello World!&lt;/div&gt;'}}},
{opcode:'getBatteryLevel',blockType:Scratch.BlockType.REPORTER,text:'获取电池电量百分比'},
{opcode:'vibrateDevice',blockType:Scratch.BlockType.COMMAND,text:'振动设备 [DURATION] 毫秒',arguments:{DURATION:{type:Scratch.ArgumentType.NUMBER,defaultValue:200}}},
{opcode:'shareContent',blockType:Scratch.BlockType.COMMAND,text:'分享内容 [TEXT] [URL]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'看看这个!'},URL:{type:Scratch.ArgumentType.STRING,defaultValue:window.location.href}}},
{opcode:'getScreenResolution',blockType:Scratch.BlockType.REPORTER,text:'获取屏幕分辨率'},
{opcode:'checkNetworkSpeed',blockType:Scratch.BlockType.REPORTER,text:'检测网络连接速度'},
{opcode:'getClipboardText',blockType:Scratch.BlockType.REPORTER,text:'获取剪贴板文本'},
{opcode:'takeScreenshot',blockType:Scratch.BlockType.COMMAND,text:'截取屏幕截图'},
{opcode:'getSystemTheme',blockType:Scratch.BlockType.REPORTER,text:'获取系统主题模式'},
{opcode:'getUserLanguage',blockType:Scratch.BlockType.REPORTER,text:'获取系统语言'},
{opcode:'getCPUInfo',blockType:Scratch.BlockType.REPORTER,text:'获取CPU核心数'},
{opcode:'isCookieEnabled',blockType:Scratch.BlockType.BOOLEAN,text:'Cookie是否启用'},
{opcode:'getPageFavicon',blockType:Scratch.BlockType.REPORTER,text:'获取网站图标URL'},
{opcode:'getMemoryInfo',blockType:Scratch.BlockType.REPORTER,text:'获取内存信息'},
{opcode:'getUserAgent',blockType:Scratch.BlockType.REPORTER,text:'获取浏览器UserAgent'},
{opcode:'getViewportSize',blockType:Scratch.BlockType.REPORTER,text:'获取视口大小'},
{opcode:'isJavaScriptEnabled',blockType:Scratch.BlockType.BOOLEAN,text:'JavaScript是否启用'},
{opcode:'getPlatformInfo',blockType:Scratch.BlockType.REPORTER,text:'获取平台信息'},
{opcode:'getConnectionType',blockType:Scratch.BlockType.REPORTER,text:'获取网络连接类型'},
{opcode:'getPageLoadTime',blockType:Scratch.BlockType.REPORTER,text:'获取页面加载时间'},
{opcode:'getScrollPosition',blockType:Scratch.BlockType.REPORTER,text:'获取滚动位置'},
{opcode:'isDoNotTrackEnabled',blockType:Scratch.BlockType.BOOLEAN,text:'是否启用禁止跟踪'},
{opcode:'getReferrer',blockType:Scratch.BlockType.REPORTER,text:'获取来源页面'},
{opcode:'getTimezone',blockType:Scratch.BlockType.REPORTER,text:'获取时区信息'},
{opcode:'getDeviceOrientation',blockType:Scratch.BlockType.REPORTER,text:'获取设备方向'},
{opcode:'getNetworkLatency',blockType:Scratch.BlockType.REPORTER,text:'检测网络延迟'},
{opcode:'getStorageUsage',blockType:Scratch.BlockType.REPORTER,text:'获取存储使用情况'},
{opcode:'isPWAInstalled',blockType:Scratch.BlockType.BOOLEAN,text:'是否为PWA应用'},
{opcode:'getMediaDevices',blockType:Scratch.BlockType.REPORTER,text:'获取媒体设备列表'},
{opcode:'createQRCode',blockType:Scratch.BlockType.REPORTER,text:'生成二维码 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'https://scratch.mit.edu'}}},
{opcode:'speakText',blockType:Scratch.BlockType.COMMAND,text:'朗读文本 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'}}},
{opcode:'stopSpeaking',blockType:Scratch.BlockType.COMMAND,text:'停止朗读'},
{opcode:'getGeolocation',blockType:Scratch.BlockType.REPORTER,text:'获取地理位置坐标'},
{opcode:'getSunriseSunset',blockType:Scratch.BlockType.REPORTER,text:'获取日出日落时间'},
{opcode:'calculateAge',blockType:Scratch.BlockType.REPORTER,text:'计算年龄 生日:[BIRTHDAY]',arguments:{BIRTHDAY:{type:Scratch.ArgumentType.STRING,defaultValue:'2000.1.1'}}},
{opcode:'countdownTimer',blockType:Scratch.BlockType.REPORTER,text:'倒计时 [TARGET_TIME]',arguments:{TARGET_TIME:{type:Scratch.ArgumentType.STRING,defaultValue:'2025-12-31 23:59:59'}}},
{opcode:'getMoonPhase',blockType:Scratch.BlockType.REPORTER,text:'获取今日月相'},
{opcode:'generatePassword',blockType:Scratch.BlockType.REPORTER,text:'生成密码 长度:[LENGTH]',arguments:{LENGTH:{type:Scratch.ArgumentType.NUMBER,defaultValue:12}}},
{opcode:'analyzeText',blockType:Scratch.BlockType.REPORTER,text:'分析文本 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'}}},
{opcode:'getCurrentSeason',blockType:Scratch.BlockType.REPORTER,text:'获取当前季节'},
{opcode:'isLeapYear',blockType:Scratch.BlockType.BOOLEAN,text:'[YEAR] 是否为闰年',arguments:{YEAR:{type:Scratch.ArgumentType.NUMBER,defaultValue:2024}}},
{opcode:'getURLParameters',blockType:Scratch.BlockType.REPORTER,text:'获取URL参数'},
{opcode:'setLocalStorage',blockType:Scratch.BlockType.COMMAND,text:'本地存储 [KEY] [VALUE]',arguments:{KEY:{type:Scratch.ArgumentType.STRING,defaultValue:'key'},VALUE:{type:Scratch.ArgumentType.STRING,defaultValue:'value'}}},
{opcode:'getLocalStorage',blockType:Scratch.BlockType.REPORTER,text:'读取本地存储 [KEY]',arguments:{KEY:{type:Scratch.ArgumentType.STRING,defaultValue:'key'}}},
{opcode:'removeLocalStorage',blockType:Scratch.BlockType.COMMAND,text:'删除本地存储 [KEY]',arguments:{KEY:{type:Scratch.ArgumentType.STRING,defaultValue:'key'}}},
{opcode:'clearLocalStorage',blockType:Scratch.BlockType.COMMAND,text:'清空本地存储'},
{opcode:'getPerformanceMetrics',blockType:Scratch.BlockType.REPORTER,text:'获取性能指标'},
{opcode:'detectAdBlocker',blockType:Scratch.BlockType.BOOLEAN,text:'是否启用广告拦截器'},
{opcode:'getPageVisibility',blockType:Scratch.BlockType.REPORTER,text:'获取页面可见状态'},
{opcode:'createBlobURL',blockType:Scratch.BlockType.REPORTER,text:'创建Blob URL 内容:[CONTENT] 类型:[TYPE]',arguments:{CONTENT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'},TYPE:{type:Scratch.ArgumentType.STRING,defaultValue:'text/plain'}}},
{opcode:'revokeBlobURL',blockType:Scratch.BlockType.COMMAND,text:'撤销Blob URL [URL]',arguments:{URL:{type:Scratch.ArgumentType.STRING,defaultValue:'blob:https://example.com'}}},
{opcode:'getElementCount',blockType:Scratch.BlockType.REPORTER,text:'获取页面元素数量 [SELECTOR]',arguments:{SELECTOR:{type:Scratch.ArgumentType.STRING,defaultValue:'div'}}},
{opcode:'checkFontSupport',blockType:Scratch.BlockType.REPORTER,text:'检查字体支持 [FONT]',arguments:{FONT:{type:Scratch.ArgumentType.STRING,defaultValue:'Arial'}}},
{opcode:'getCSSVariable',blockType:Scratch.BlockType.REPORTER,text:'获取CSS变量值 [VAR_NAME]',arguments:{VAR_NAME:{type:Scratch.ArgumentType.STRING,defaultValue:'--main-color'}}},
{opcode:'setCSSVariable',blockType:Scratch.BlockType.COMMAND,text:'设置CSS变量 [VAR_NAME] [VALUE]',arguments:{VAR_NAME:{type:Scratch.ArgumentType.STRING,defaultValue:'--main-color'},VALUE:{type:Scratch.ArgumentType.STRING,defaultValue:'#5ca05c'}}},
{opcode:'createObjectURL',blockType:Scratch.BlockType.REPORTER,text:'创建对象URL 文件:[FILE]',arguments:{FILE:{type:Scratch.ArgumentType.STRING,defaultValue:'data:text/plain,Hello'}}},
{opcode:'measureTextWidth',blockType:Scratch.BlockType.REPORTER,text:'测量文本宽度 [TEXT] 字体:[FONT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'},FONT:{type:Scratch.ArgumentType.STRING,defaultValue:'16px Arial'}}},
{opcode:'getScrollbarWidth',blockType:Scratch.BlockType.REPORTER,text:'获取滚动条宽度'},
{opcode:'isReduceMotionEnabled',blockType:Scratch.BlockType.BOOLEAN,text:'是否启用减少动画'},
{opcode:'detectIncognitoMode',blockType:Scratch.BlockType.BOOLEAN,text:'是否处于无痕模式'},
{opcode:'getDeviceMotion',blockType:Scratch.BlockType.REPORTER,text:'获取设备加速度'},
{opcode:'createHash',blockType:Scratch.BlockType.REPORTER,text:'生成哈希值 [ALGORITHM] [TEXT]',arguments:{ALGORITHM:{type:Scratch.ArgumentType.STRING,menu:'hashMenu',defaultValue:'MD5'},TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'}}},
{opcode:'compressText',blockType:Scratch.BlockType.REPORTER,text:'压缩文本 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'}}},
{opcode:'decompressText',blockType:Scratch.BlockType.REPORTER,text:'解压文本 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'eJzzSM3JyVcIzy/KSVEEABK5A5A='}}},
{opcode:'detectDarkPattern',blockType:Scratch.BlockType.BOOLEAN,text:'检测深色模式偏好'},
{opcode:'getAudioContext',blockType:Scratch.BlockType.REPORTER,text:'获取音频上下文状态'},
{opcode:'calculateTextReadTime',blockType:Scratch.BlockType.REPORTER,text:'计算文本阅读时间 [TEXT]',arguments:{TEXT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello World'}}},
{opcode:'generateUUID',blockType:Scratch.BlockType.REPORTER,text:'生成UUID'},
{opcode:'checkImageExists',blockType:Scratch.BlockType.BOOLEAN,text:'检查图片是否存在 [URL]',arguments:{URL:{type:Scratch.ArgumentType.STRING,defaultValue:'https://example.com/image.jpg'}}},
{opcode:'getCookieValue',blockType:Scratch.BlockType.REPORTER,text:'获取Cookie值 [NAME]',arguments:{NAME:{type:Scratch.ArgumentType.STRING,defaultValue:'session'}}},
{opcode:'setCookieValue',blockType:Scratch.BlockType.COMMAND,text:'设置Cookie [NAME] [VALUE] [DAYS]',arguments:{NAME:{type:Scratch.ArgumentType.STRING,defaultValue:'session'},VALUE:{type:Scratch.ArgumentType.STRING,defaultValue:'value'},DAYS:{type:Scratch.ArgumentType.NUMBER,defaultValue:7}}},
{opcode:'getBatteryStatus',blockType:Scratch.BlockType.REPORTER,text:'获取电池状态详情'},
{opcode:'detectIdleState',blockType:Scratch.BlockType.REPORTER,text:'检测用户空闲状态'},
{opcode:'calculateDistance',blockType:Scratch.BlockType.REPORTER,text:'计算两点距离 点1:[POINT1] 点2:[POINT2]',arguments:{POINT1:{type:Scratch.ArgumentType.STRING,defaultValue:'0,0'},POINT2:{type:Scratch.ArgumentType.STRING,defaultValue:'3,4'}}},
{opcode:'generateLoremIpsum',blockType:Scratch.BlockType.REPORTER,text:'生成Lorem Ipsum文本 [WORDS]词',arguments:{WORDS:{type:Scratch.ArgumentType.NUMBER,defaultValue:50}}},
{opcode:'checkSSLStatus',blockType:Scratch.BlockType.BOOLEAN,text:'当前页面是否使用HTTPS'},
{opcode:'getPageLoadSize',blockType:Scratch.BlockType.REPORTER,text:'获取页面加载资源大小'},
{opcode:'detectPrintSupport',blockType:Scratch.BlockType.BOOLEAN,text:'是否支持打印功能'},
{opcode:'createDataURL',blockType:Scratch.BlockType.REPORTER,text:'创建Data URL 内容:[CONTENT] 类型:[TYPE]',arguments:{CONTENT:{type:Scratch.ArgumentType.STRING,defaultValue:'Hello'},TYPE:{type:Scratch.ArgumentType.STRING,defaultValue:'text/plain'}}},
{opcode:'getActiveElement',blockType:Scratch.BlockType.REPORTER,text:'获取当前焦点元素'},
{opcode:'checkWebGLSupport',blockType:Scratch.BlockType.BOOLEAN,text:'是否支持WebGL'},
{opcode:'getSelectionText',blockType:Scratch.BlockType.REPORTER,text:'获取选中文本'},
{opcode:'detectPointerType',blockType:Scratch.BlockType.REPORTER,text:'检测指针设备类型'},
{opcode:'calculateAspectRatio',blockType:Scratch.BlockType.REPORTER,text:'计算宽高比 宽:[WIDTH] 高:[HEIGHT]',arguments:{WIDTH:{type:Scratch.ArgumentType.NUMBER,defaultValue:16},HEIGHT:{type:Scratch.ArgumentType.NUMBER,defaultValue:9}}},
{opcode:'generateGradient',blockType:Scratch.BlockType.REPORTER,text:'生成CSS渐变 [COLOR1] [COLOR2]',arguments:{COLOR1:{type:Scratch.ArgumentType.STRING,defaultValue:'#FF0000'},COLOR2:{type:Scratch.ArgumentType.STRING,defaultValue:'#0000FF'}}},
{opcode:'checkServiceWorker',blockType:Scratch.BlockType.BOOLEAN,text:'是否注册Service Worker'}],
menus:{
base64Menu:{items:['编码','解码']},
hashMenu:{items:['MD5','SHA-1','SHA-256','SHA-512']}
},
docsURI:'https://ccwmoran.github.io'}}

getDeviceModel(){let e=navigator.userAgent;return/iPhone/.test(e)?'iPhone':/iPad/.test(e)?'iPad':/Android/.test(e)?'Android设备':/Windows/.test(e)?'Windows电脑':/Mac/.test(e)?'Mac电脑':/Linux/.test(e)?'Linux电脑':'未知设备'}
getBrowserName(){let e=navigator.userAgent;return e.indexOf('Chrome')&gt;-1&amp;&amp;e.indexOf('Edge')===-1?'Chrome':e.indexOf('Firefox')&gt;-1?'Firefox':e.indexOf('Safari')&gt;-1&amp;&amp;e.indexOf('Chrome')===-1?'Safari':e.indexOf('Edge')&gt;-1?'Edge':e.indexOf('Opera')&gt;-1?'Opera':e.indexOf('MSIE')&gt;-1||e.indexOf('Trident')&gt;-1?'Internet Explorer':'未知浏览器'}
toggleFullscreen(){if(!document.fullscreenElement){document.documentElement.requestFullscreen?.()||document.documentElement.mozRequestFullScreen?.()||document.documentElement.webkitRequestFullscreen?.()||document.documentElement.msRequestFullscreen?.()}else{document.exitFullscreen?.()||document.mozCancelFullScreen?.()||document.webkitExitFullscreen?.()||document.msExitFullscreen?.()}}
isTouchSupported(){return'ontouchstart'in window||navigator.maxTouchPoints&gt;0}
generateRandomColor(){let e='0123456789ABCDEF',t='#';for(let o=0;o&lt;6;o++)t+=e[Math.floor(Math.random()*16)];return t}
generateRandomInt(e){let t=e.DIGITS,o=Math.pow(10,t-1),n=Math.pow(10,t)-1;return Math.floor(Math.random()*(n-o+1))+o}
isOnline(){return navigator.onLine}
isInEditor(){return window.location.href.indexOf('scratch.mit.edu')&gt;-1&amp;&amp;window.location.href.indexOf('/projects/')&gt;-1}
hasCamera(){return new Promise(e=&gt;{navigator.mediaDevices?.enumerateDevices?.().then(t=&gt;{e(t.some(e=&gt;e.kind==='videoinput'))}).catch(()=&gt;e(false))})}
getCurrentDate(){let e=new Date();return e.getFullYear()+'-'+String(e.getMonth()+1).padStart(2,'0')+'-'+String(e.getDate()).padStart(2,'0')}
getCurrentTime(){let e=new Date();return String(e.getHours()).padStart(2,'0')+':'+String(e.getMinutes()).padStart(2,'0')+':'+String(e.getSeconds()).padStart(2,'0')}
getWeekday(){return['星期日','星期一','星期二','星期三','星期四','星期五','星期六'][new Date().getDay()]}
showAlert(e){alert(e.TEXT)}
showPrompt(e){return prompt(e.QUESTION)}
showOptions(e){let t=e.OPTIONS.split(','),o='&lt;div style='font-family:Arial,sans-serif;padding:10px;'&gt;&lt;p style='margin-top:0;'&gt;请选择一个选项:&lt;/p&gt;';t.forEach((e,n)=&gt;{o+=`&lt;label style='display:block;margin:5px 0;'&gt;&lt;input type='radio' name='option' value='${e}' ${0===n?'checked':''}&gt;${e}&lt;/label&gt;`});o+='&lt;/div&gt;';let n=this.showCustomDialog('选择选项',o);return n||t[0]||''}
showDatePicker(){let e=document.createElement('input');e.type='date',e.showPicker();return e.value||new Date().toISOString().slice(0,10)}
showColorPicker(){let e=document.createElement('input');e.type='color',e.showPicker();return e.value||'#000000'}
showCustomDialog(e,t,o=!1){return new Promise(n=&gt;{let c=document.createElement('div');c.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:10000';let r=document.createElement('div');r.style.cssText='background:white;border-radius:8px;padding:0;min-width:300px;max-width:90%;box-shadow:0 4px 20px rgba(0,0,0,0.3)';let i=document.createElement('div');i.style.cssText='background:#5ca05c;color:white;padding:10px 15px;border-radius:8px 8px 0 0;font-weight:bold';i.textContent=e;let a=document.createElement('div');a.innerHTML=t;let l=document.createElement('div');l.style.cssText='display:flex;justify-content:flex-end;padding:10px 15px;border-top:1px solid #eee';let s=document.createElement('button');s.textContent='取消',s.style.cssText='margin-right:10px;padding:5px 15px;background:#f0f0f0;border:1px solid #ccc;border-radius:4px;cursor:pointer';let d=document.createElement('button');d.textContent='确定',d.style.cssText='padding:5px 15px;background:#5ca05c;color:white;border:none;border-radius:4px;cursor:pointer';l.appendChild(s),l.appendChild(d),r.appendChild(i),r.appendChild(a),r.appendChild(l),c.appendChild(r),document.body.appendChild(c);let u=t=&gt;{document.body.removeChild(c),n(t)};s.onclick=()=&gt;u(null),d.onclick=()=&gt;{let e=o?a.querySelector('input')?.value:a.querySelector('input[name='option']:checked')?.value;u(e)},c.onclick=e=&gt;{e.target===c&amp;&amp;u(null)}})}
getCurrentURL(){return window.location.href}
getCurrentTitle(){return document.title}
openInNewTab(e){window.open(e.URL,'_blank')}
setPageTitle(e){document.title=e.TITLE}
refreshPage(){window.location.reload()}
copyToClipboard(e){let t=document.createElement('textarea');t.value=e.TEXT,document.body.appendChild(t),t.select();try{document.execCommand('copy')}catch(e){}document.body.removeChild(t)}
base64Operation(e){let t=e.OPERATION,o=e.CONTENT;try{return'编码'===t?btoa(unescape(encodeURIComponent(o))):decodeURIComponent(escape(atob(o)))}catch(e){return'编码'===t?'编码失败':'解码失败'}}
getLocationInfo(){return new Promise(e=&gt;{fetch('https://ipapi.co/json/').then(t=&gt;t.json()).then(t=&gt;{e(t.country_name&amp;&amp;t.region&amp;&amp;t.city?`${t.country_name}-${t.region}-${t.city}`:'位置信息不可用')}).catch(()=&gt;e('位置服务暂时不可用'))})}
downloadFile(e){let t=e.CONTENT,o=e.FILENAME,n=new Blob([t],{type:'text/plain;charset=utf-8'}),c=URL.createObjectURL(n),r=document.createElement('a');r.href=c,r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c)}
calculateDaysBetween(e){let t=e.START,o=e.END,n=new Date(t.replace(/\./g,'/')),c=new Date(o.replace(/\./g,'/'));if(isNaN(n)||isNaN(c))return'日期格式错误';let r=Math.abs(c-n),i=Math.ceil(r/(1e3*60*60*24));return i}
closeCurrentPage(){window.close()}
generateRandomEmojis(e){let t=e.COUNT,o=['😀','😂','🥰','😎','🤩','😍','🤗','🙂','😊','😇','🥳','😜','🤪','😋','😛','👏','👍','❤️','🔥','⭐','🌈','🎉','🎁','🎂','🎈','💯','✨','🌟','💫','💥','💖','💕','💞','💓','💗','🔥','🌟','💫','⭐','🌈','🌞','🌻','🌸','🌺','🍀','🎵','🎶','🎨','🏆','🎮','🎯','⚽','🏀','🎾','🏐','🎱'],n='';for(let e=0;e&lt;t;e++)n+=o[Math.floor(Math.random()*o.length)];return n}
runHTMLCode(e){try{let t=document.createElement('div');t.innerHTML=e.HTML_CODE,document.body.appendChild(t)}catch(e){}}
getBatteryLevel(){return new Promise(e=&gt;{if(navigator.getBattery){navigator.getBattery().then(t=&gt;{e(Math.round(t.level*100)+'%')}).catch(()=&gt;e('未知'))}else{e('不支持电池API')}})}
vibrateDevice(e){if(navigator.vibrate){navigator.vibrate(e.DURATION)}}
shareContent(e){if(navigator.share){navigator.share({title:document.title,text:e.TEXT,url:e.URL}).catch(()=&gt;{})}}
getScreenResolution(){return screen.width+'×'+screen.height}
checkNetworkSpeed(){return new Promise(e=&gt;{let t=performance.getEntriesByType('navigation');if(t.length&gt;0){let o=t[0];if(o.domainLookupEnd&amp;&amp;o.connectEnd&amp;&amp;o.responseEnd&amp;&amp;o.requestStart){let n=o.domainLookupEnd-o.domainLookupStart,c=o.connectEnd-o.connectStart,r=o.responseEnd-o.requestStart;e(`DNS:${n.toFixed(2)}ms 连接:${c.toFixed(2)}ms 响应:${r.toFixed(2)}ms`)}else{e('无法获取网络速度详情')}}else{e('网络信息不可用')}})}
getClipboardText(){return new Promise(e=&gt;{navigator.clipboard?.readText?.().then(t=&gt;e(t)).catch(()=&gt;e('无法读取剪贴板'))})}
takeScreenshot(){html2canvas(document.body).then(e=&gt;{let t=e.toDataURL('image/png'),o=document.createElement('a');o.href=t,o.download='screenshot.png',o.click()})}
getSystemTheme(){return window.matchMedia&amp;&amp;window.matchMedia('(prefers-color-scheme: dark)').matches?'深色模式':'浅色模式'}
getUserLanguage(){return navigator.language||navigator.userLanguage||'未知'}
getCPUInfo(){return navigator.hardwareConcurrency?navigator.hardwareConcurrency+'核心':'未知'}
isCookieEnabled(){return navigator.cookieEnabled}
getPageFavicon(){let e=document.querySelector('link[rel*='icon']');return e?e.href:'无图标'}
getMemoryInfo(){return navigator.deviceMemory?navigator.deviceMemory+'GB':'未知'}
getUserAgent(){return navigator.userAgent}
getViewportSize(){return window.innerWidth+'×'+window.innerHeight}
isJavaScriptEnabled(){return true}
getPlatformInfo(){return navigator.platform||'未知平台'}
getConnectionType(){let e=navigator.connection;return e?e.effectiveType||'未知':'未知'}
getPageLoadTime(){let e=performance.timing;return e.loadEventEnd-e.navigationStart+'ms'}
getScrollPosition(){return window.pageYOffset+'px'}
isDoNotTrackEnabled(){return navigator.doNotTrack===1||navigator.doNotTrack==='1'||navigator.msDoNotTrack==='1'||window.doNotTrack==='1'}
getReferrer(){return document.referrer||'无来源页面'}
getTimezone(){return Intl.DateTimeFormat().resolvedOptions().timeZone}
getDeviceOrientation(){return new Promise(e=&gt;{if(window.DeviceOrientationEvent){window.addEventListener('deviceorientation',t=&gt;{e(`Alpha:${t.alpha?.toFixed(2)} Beta:${t.beta?.toFixed(2)} Gamma:${t.gamma?.toFixed(2)}`)},{once:!0})}else{e('不支持设备方向检测')}})}
getNetworkLatency(){return new Promise(e=&gt;{let t=performance.now();fetch('https://www.google.com/favicon.ico?t='+Date.now(),{mode:'no-cors',cache:'no-cache'}).then(()=&gt;{e((performance.now()-t).toFixed(2)+'ms')}).catch(()=&gt;e('检测失败'))})}
getStorageUsage(){return new Promise(e=&gt;{if(navigator.storage&amp;&amp;navigator.storage.estimate){navigator.storage.estimate().then(t=&gt;{let o=(t.usage/1024/1024).toFixed(2),n=(t.quota/1024/1024).toFixed(2);e(`已用:${o}MB 总额:${n}MB`)}).catch(()=&gt;e('存储信息不可用'))}else{e('不支持存储API')}})}
isPWAInstalled(){return window.matchMedia('(display-mode: standalone)').matches||window.navigator.standalone||document.referrer.includes('android-app://')}
getMediaDevices(){return new Promise(e=&gt;{navigator.mediaDevices?.enumerateDevices?.().then(t=&gt;{let o=t.map(t=&gt;`${t.kind}:${t.label||'未知'}`).join('; ');e(o||'无媒体设备')}).catch(()=&gt;e('无法获取设备列表'))})}
createQRCode(e){return`https://api.qrserver.com/v1/create-qr-code/?size=150x150&amp;data=${encodeURIComponent(e.TEXT)}`}
speakText(e){if('speechSynthesis'in window){let t=new SpeechSynthesisUtterance(e.TEXT);speechSynthesis.speak(t)}}
stopSpeaking(){speechSynthesis.cancel()}
getGeolocation(){return new Promise(e=&gt;{if('geolocation'in navigator){navigator.geolocation.getCurrentPosition(t=&gt;{e(`纬度:${t.coords.latitude.toFixed(6)} 经度:${t.coords.longitude.toFixed(6)}`)},()=&gt;e('位置获取失败'))}else{e('不支持地理位置')}})}
getSunriseSunset(){return new Promise(e=&gt;{fetch('https://api.sunrise-sunset.org/json?lat=36.7201600&amp;lng=-4.4203400&amp;formatted=0').then(t=&gt;t.json()).then(t=&gt;{t.results?e(`日出:${t.results.sunrise} 日落:${t.results.sunset}`):e('数据获取失败')}).catch(()=&gt;e('服务不可用'))})}
calculateAge(e){let t=new Date(e.BIRTHDAY.replace(/\./g,'/')),o=new Date(),n=o.getFullYear()-t.getFullYear(),c=o.getMonth()-t.getMonth();return c&lt;0||0===c&amp;&amp;o.getDate()&lt;t.getDate()?n-1:n}
countdownTimer(e){let t=new Date(e.TARGET_TIME),o=new Date(),n=t-o;return n&lt;=0?'时间已到':`${Math.floor(n/(1e3*60*60*24))}天${Math.floor(n%(1e3*60*60*24)/(1e3*60*60))}小时${Math.floor(n%(1e3*60*60)/(1e3*60))}分钟`}
getMoonPhase(){let e=new Date(),t=e.getDate(),o=e.getMonth()+1,n=e.getFullYear(),c=(n%100+Math.floor((n%100)/4))%7;return['新月','娥眉月','上弦月','盈凸月','满月','亏凸月','下弦月','残月'][Math.floor(t%8)]}
generatePassword(e){let t=e.LENGTH,o='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*',n='';for(let e=0;e&lt;t;e++)n+=o[Math.floor(Math.random()*o.length)];return n}
analyzeText(e){let t=e.TEXT,o=t.length,n=t.split(/\s+/).length,c=t.split(/[.!?]+/).length-1;return`字符数:${o} 单词数:${n} 句子数:${c}`}
getCurrentSeason(){let e=new Date(),t=e.getMonth();return t&gt;=2&amp;&amp;t&lt;=4?'春季':t&gt;=5&amp;&amp;t&lt;=7?'夏季':t&gt;=8&amp;&amp;t&lt;=10?'秋季':'冬季'}
isLeapYear(e){let t=e.YEAR;return t%4==0&amp;&amp;t%100!=0||t%400==0}
getURLParameters(){let e=new URLSearchParams(window.location.search),t=[];for(let o of e.entries())t.push(`${o[0]}=${o[1]}`);return t.join(', ')}
setLocalStorage(e){localStorage.setItem(e.KEY,e.VALUE)}
getLocalStorage(e){return localStorage.getItem(e.KEY)||''}
removeLocalStorage(e){localStorage.removeItem(e.KEY)}
clearLocalStorage(){localStorage.clear()}
getPerformanceMetrics(){let e=performance.getEntriesByType('navigation')[0];if(e){let t=e.domContentLoadedEventEnd-e.navigationStart,o=e.loadEventEnd-e.navigationStart;return`DOM加载:${t}ms 完全加载:${o}ms`}return'性能数据不可用'}
detectAdBlocker(){return new Promise(e=&gt;{fetch('https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js',{method:'HEAD',mode:'no-cors'}).then(()=&gt;e(false)).catch(()=&gt;e(true))})}
getPageVisibility(){return document.hidden?'页面隐藏':'页面可见'}
createBlobURL(e){let t=new Blob([e.CONTENT],{type:e.TYPE});return URL.createObjectURL(t)}
revokeBlobURL(e){URL.revokeObjectURL(e.URL)}
getElementCount(e){return document.querySelectorAll(e.SELECTOR).length}
checkFontSupport(e){let t=document.createElement('span');t.style.fontFamily=e.FONT,t.style.position='absolute',t.style.left='-9999px',t.innerHTML='mmmmmmmmmmmmmmmm';document.body.appendChild(t);let o=t.offsetWidth;document.body.removeChild(t);let n=document.createElement('span');n.style.fontFamily='monospace',n.style.position='absolute',n.style.left='-9999px',n.innerHTML='mmmmmmmmmmmmmmmm';document.body.appendChild(n);let c=n.offsetWidth;return document.body.removeChild(n),o!==c}
getCSSVariable(e){return getComputedStyle(document.documentElement).getPropertyValue(e.VAR_NAME).trim()}
setCSSVariable(e){document.documentElement.style.setProperty(e.VAR_NAME,e.VALUE)}
createObjectURL(e){let t=new Blob([e.FILE],{type:'text/plain'});return URL.createObjectURL(t)}
measureTextWidth(e){let t=document.createElement('canvas'),o=t.getContext('2d');return o.font=e.FONT,Math.ceil(o.measureText(e.TEXT).width)}
getScrollbarWidth(){let e=document.createElement('div');e.style.overflow='scroll',e.style.width='50px',e.style.height='50px',e.style.visibility='hidden',e.style.position='absolute',e.style.top='-9999px';document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}
isReduceMotionEnabled(){return window.matchMedia('(prefers-reduced-motion: reduce)').matches}
detectIncognitoMode(){return new Promise(e=&gt;{let t=!1;'storage'in navigator&amp;&amp;navigator.storage.estimate?navigator.storage.estimate().then(o=&gt;{t=o.quota&lt;12e9}).catch(()=&gt;t=!1):t=!1,e(t)})}
getDeviceMotion(){return new Promise(e=&gt;{if(window.DeviceMotionEvent){window.addEventListener('devicemotion',t=&gt;{e(`X:${t.acceleration?.x?.toFixed(2)} Y:${t.acceleration?.y?.toFixed(2)} Z:${t.acceleration?.z?.toFixed(2)}`)},{once:!0})}else{e('不支持设备运动检测')}})}
createHash(e){let t=e.ALGORITHM,o=e.TEXT,n=0;for(let e=0;e&lt;o.length;e++)n=((n&lt;&lt;5)-n)+o.charCodeAt(e),n&amp;=n;return'MD5'===t?(n&gt;&gt;&gt;0).toString(16):'SHA-1'===t?(n+2147483648).toString(16):'SHA-256'===t?(n*2654435761&gt;&gt;&gt;0).toString(16):(n^123456789).toString(16)}
compressText(e){try{return btoa(encodeURIComponent(e.TEXT).replace(/%([0-9A-F]{2})/g,(e,t)=&gt;String.fromCharCode('0x'+t)))}catch(e){return'压缩失败'}}
decompressText(e){try{return decodeURIComponent(atob(e.TEXT).split('').map(e=&gt;'%'+('00'+e.charCodeAt(0).toString(16)).slice(-2)).join(''))}catch(e){return'解压失败'}}
detectDarkPattern(){return window.matchMedia&amp;&amp;window.matchMedia('(prefers-color-scheme: dark)').matches?'深色模式':'浅色模式'}
getAudioContext(){return'undefined'!=typeof AudioContext?'音频上下文可用':'音频上下文不可用'}
calculateTextReadTime(e){let t=e.TEXT.length;return Math.ceil(t/200)+'分钟'}
generateUUID(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,e=&gt;{let t=16*Math.random()|0;return('x'===e?t:3&amp;t|8).toString(16)})}
checkImageExists(e){return new Promise(t=&gt;{let o=new Image;o.onload=()=&gt;t(!0),o.onerror=()=&gt;t(!1),o.src=e.URL})}
getCookieValue(e){let t=`; ${document.cookie}`,o=t.split(`; ${e.NAME}=`);return 2===o.length?o.pop().split(';').shift():''}
setCookieValue(e){let t=e.NAME,o=e.VALUE,n=e.DAYS,c=new Date;c.setTime(c.getTime()+24*n*60*60*1e3);let r='expires='+c.toUTCString();document.cookie=t+'='+o+';'+r+';path=/'}
getBatteryStatus(){return new Promise(e=&gt;{if(navigator.getBattery){navigator.getBattery().then(t=&gt;{e(`电量:${Math.round(t.level*100)}% 充电中:${t.charging?'是':'否'} 充电时间:${t.chargingTime?Math.round(t.chargingTime/60)+'分钟':'未知'} 放电时间:${t.dischargingTime?Math.round(t.dischargingTime/60)+'分钟':'未知'}`)}).catch(()=&gt;e('电池状态未知'))}else{e('不支持电池API')}})}
detectIdleState(){return new Promise(e=&gt;{if('requestIdleCallback'in window){let t=performance.now();window.requestIdleCallback(()=&gt;{e(`空闲时间:${Math.round(performance.now()-t)}ms`)})}else{e('不支持空闲检测')}})}
calculateDistance(e){let t=e.POINT1.split(',').map(Number),o=e.POINT2.split(',').map(Number);if(t.length!==2||o.length!==2||t.some(isNaN)||o.some(isNaN))return'坐标格式错误';let n=t[0]-o[0],c=t[1]-o[1];return Math.sqrt(n*n+c*c).toFixed(2)}
generateLoremIpsum(e){let t=e.WORDS,o=['lorem','ipsum','dolor','sit','amet','consectetur','adipiscing','elit','sed','do','eiusmod','tempor','incididunt','ut','labore','et','dolore','magna','aliqua','enim','minim','veniam','quis','nostrud','exercitation','ullamco','laboris','nisi','aliquip','ex','ea','commodo','consequat','duis','aute','irure','in','reprehenderit','voluptate','velit','esse','cillum','eu','fugiat','nulla','pariatur','excepteur','sint','occaecat','cupidatat','non','proident','sunt','culpa','qui','officia','deserunt','mollit','anim','id','est','laborum'],n='';for(let e=0;e&lt;t;e++)n+=(e&gt;0?' ':'')+o[Math.floor(Math.random()*o.length)];return n+'.'}
checkSSLStatus(){return window.location.protocol==='https:'}
getPageLoadSize(){let e=performance.getEntriesByType('resource').reduce((e,t)=&gt;e+t.transferSize||0,0);return(e/1024).toFixed(2)+'KB'}
detectPrintSupport(){return!!window.matchMedia&amp;&amp;!!window.matchMedia('print')}
createDataURL(e){return`data:${e.TYPE},${encodeURIComponent(e.CONTENT)}`}
getActiveElement(){let e=document.activeElement;return e?e.tagName+ (e.id?'#'+e.id:'')+ (e.className?'.'+e.className.split(' ')[0]:''):'无焦点元素'}
checkWebGLSupport(){let e=document.createElement('canvas');return!!(e.getContext('webgl')||e.getContext('experimental-webgl'))}
getSelectionText(){let e=window.getSelection();return e?e.toString():'无选中文本'}
detectPointerType(){return window.matchMedia&amp;&amp;window.matchMedia('(pointer:coarse)').matches?'触摸设备':window.matchMedia&amp;&amp;window.matchMedia('(pointer:fine)').matches?'鼠标设备':'未知指针设备'}
calculateAspectRatio(e){let t=e.WIDTH,o=e.HEIGHT;if(t&lt;=0||o&lt;=0)return'无效尺寸';let n=this.gcd(t,o);return`${t/n}:${o/n}`}
gcd(e,t){return t===0?e:this.gcd(t,e%t)}
generateGradient(e){return`linear-gradient(45deg, ${e.COLOR1}, ${e.COLOR2})`}
checkServiceWorker(){return'navigator' in window&amp;&amp;'serviceWorker' in navigator?!!navigator.serviceWorker.controller:'不支持Service Worker'}}

Scratch.extensions.register(new MorganToolboxV8());
```
。</description><guid isPermaLink="true">https://ccwmoran.github.io/code/post/Morgan-de-gong-ju-xiang-V8.html</guid><pubDate>Sun, 30 Nov 2025 09:27:16 +0000</pubDate></item></channel></rss>